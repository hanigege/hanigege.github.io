<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Routers on 代碼倉庫</title><link>https://hanigege.github.io/categories/routers/</link><description>Recent content in Routers on 代碼倉庫</description><generator>Hugo</generator><language>zh-CN</language><copyright>© **felix**.</copyright><lastBuildDate>Fri, 27 Feb 2026 17:20:17 +0800</lastBuildDate><atom:link href="https://hanigege.github.io/categories/routers/index.xml" rel="self" type="application/rss+xml"/><item><title>05.RouterOS如何nat回流及包含配套防火墙规则</title><link>https://hanigege.github.io/posts/routers/05.routeros%E5%A6%82%E4%BD%95nat%E5%9B%9E%E6%B5%81/</link><pubDate>Fri, 27 Feb 2026 17:20:17 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/05.routeros%E5%A6%82%E4%BD%95nat%E5%9B%9E%E6%B5%81/</guid><description>&lt;h2 id="内网的dst-nat要加外网接口如pppoe-out1"&gt;内网的dst-nat要加外网接口如pppoe-out1&lt;/h2&gt;
&lt;h2 id="1-为什么需要回流"&gt;1. 为什么需要回流？&lt;/h2&gt;
&lt;p&gt;当你从内网请求公网 IP 时，ROS 收到包后转发给内网服务器，但服务器发现请求方和自己在同一个网段，会直接把回包传给手机。手机发现自己发给公网 IP 的请求却收到了来自内网私有 IP 的响应，会因为安全机制直接丢弃该包。回流规则通过让 ROS 中转这个“回头包”来解决这个问题。&lt;/p&gt;
&lt;h2 id="2-完整的-ros-nat-脚本包含-web-回流"&gt;2. 完整的 ROS NAT 脚本（包含 Web 回流）&lt;/h2&gt;
&lt;h4 id="请根据你的实际端口修改-12335-web-和-21-ftp-等"&gt;请根据你的实际端口修改 12335 (Web) 和 21 (FTP) 等。&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall nat
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# --- 基础规则 ---
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 1. 核心上网伪装（必须限制在 WAN 口，防止干扰其他转发）
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=srcnat action=masquerade out-interface=pppoe-out1 comment=&amp;#34;Standard Internet Access&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# --- 端口转发 (DST-NAT) ---
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 2. DERP 转发
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=dstnat protocol=tcp dst-port=12340 action=dst-nat to-addresses=10.20.20.4 to-ports=12340 comment=&amp;#34;DERP TCP&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=dstnat protocol=udp dst-port=3478 action=dst-nat to-addresses=10.20.20.4 to-ports=3478 comment=&amp;#34;DERP STUN&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 3. Web 服务转发 (示例)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=dstnat protocol=tcp dst-port=12335 action=dst-nat to-addresses=10.20.20.x to-ports=12335 comment=&amp;#34;web&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 4. FTP 服务转发 (示例)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=dstnat protocol=tcp dst-port=21 action=dst-nat to-addresses=10.20.20.x to-ports=21 comment=&amp;#34;vsftpd&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# --- 回流规则 (Hairpin NAT) ---
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 只有当内网访问内网服务器时才触发。建议将所有内网服务器放在一个规则里，或者逐个添加。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 给 DERP 添加回流
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.4 protocol=tcp dst-port=12340 action=masquerade comment=&amp;#34;Hairpin DERP TCP&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.4 protocol=udp dst-port=3478 action=masquerade comment=&amp;#34;Hairpin DERP STUN&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 给 Web 服务添加回流 (假设内网 IP 为 10.20.20.5)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.5 protocol=tcp dst-port=12335 action=masquerade comment=&amp;#34;Hairpin Web&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="3-操作建议使用地址列表简化回流"&gt;3. 操作建议：使用“地址列表”简化回流&lt;/h2&gt;
&lt;p&gt;如果你有很多内网服务器需要回流，一条条加 srcnat 很麻烦。你可以这样做：&lt;/p&gt;</description></item><item><title>04.RouterOS使用queue_tree配置流量整形</title><link>https://hanigege.github.io/posts/routers/04.routeros%E4%BD%BF%E7%94%A8queue_tree%E9%85%8D%E7%BD%AE%E6%B5%81%E9%87%8F%E6%95%B4%E5%BD%A2/</link><pubDate>Fri, 27 Feb 2026 16:59:27 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/04.routeros%E4%BD%BF%E7%94%A8queue_tree%E9%85%8D%E7%BD%AE%E6%B5%81%E9%87%8F%E6%95%B4%E5%BD%A2/</guid><description>&lt;h1 id="本教程介绍使用-queue-tree-开启-ros-的流控功能"&gt;本教程介绍使用 queue tree 开启 ROS 的流控功能&lt;/h1&gt;
&lt;p&gt;本教程介绍如何使用 RouterOS 的 &lt;code&gt;queue tree&lt;/code&gt; 实现流量整形。
文章分成两种方案：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;为 DNS、Web 等小包流量设置更高优先级&lt;/strong&gt;，提高网页响应速度，适合一般用户；&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;为宽带及特定服务设定上传/下载限速，并按服务设定优先级&lt;/strong&gt;，适合 BT/PT 等大流量应用用户。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id="1为-dnsweb-等小包流量设置更高优先级提高网页响应速度适合一般用户使用"&gt;1、为 DNS、Web 等小包流量设置更高优先级，提高网页响应速度，适合一般用户使用。&lt;/h2&gt;
&lt;h3 id="添加queue-type"&gt;添加queue type&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;128&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;30ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;128&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;4096.0KiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;3ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Dns_Up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;256&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;30ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;128&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;8.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;3ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Dns_Down
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;50ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;8.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;5ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Small_Up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;50ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;16.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;5ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Small_Down
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;50ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2048&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;64.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1400&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;5ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Web_Up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1024&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;50ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;4096&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;128.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1500&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;5ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Web_Down
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1024&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;100ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;8192&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;128.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1400&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;8ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Stream_Up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2048&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;100ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;10240&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;256.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1500&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;8ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Stream_Down
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2048&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;100ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;10240&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;128.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1400&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;20ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Nomark_Up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue type add fq-codel-flows&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;4096&lt;/span&gt; fq-codel-interval&lt;span style="color:#f92672"&gt;=&lt;/span&gt;100ms fq-codel-limit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;10240&lt;/span&gt; fq-codel-memlimit&lt;span style="color:#f92672"&gt;=&lt;/span&gt;256.0MiB fq-codel-quantum&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1500&lt;/span&gt; fq-codel-target&lt;span style="color:#f92672"&gt;=&lt;/span&gt;15ms kind&lt;span style="color:#f92672"&gt;=&lt;/span&gt;fq-codel name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Fq_Codel_Nomark_Down
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="配置-queue-tree"&gt;配置 queue tree&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;自行修改桥的名称（bridge1）及pppoe拨号口（pppoe-out1）的名称&lt;/p&gt;</description></item><item><title>03.RouterOS配置FakeIP</title><link>https://hanigege.github.io/posts/routers/03.routeros%E9%85%8D%E7%BD%AEfakeip/</link><pubDate>Fri, 27 Feb 2026 16:41:22 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/03.routeros%E9%85%8D%E7%BD%AEfakeip/</guid><description>&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-markdown" data-lang="markdown"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;本文介绍使用 FakeIP 分流法实现局域网内设备透明代理时，主路由 RouterOS 部分的设置。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;注意：sing-box 及 mosdns 的具体配置不在本文讨论范围内。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;作者：Tom
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="环境设定"&gt;环境设定&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;sing-box IP&lt;/strong&gt;: IPv4 &lt;code&gt;10.0.0.2&lt;/code&gt;, IPv6 &lt;code&gt;dc00::2222&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;FakeIP 网段&lt;/strong&gt;: IPv4 &lt;code&gt;28.0.0.0/8&lt;/code&gt;, IPv6 &lt;code&gt;f2b0::/18&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;注意&lt;/strong&gt;: 开启 FastTrack 后 Mangle 会失效，建议使用 Route 或 Routing Rules 方式。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="方案-1使用-mangle-打标签方式"&gt;方案 1：使用 Mangle 打标签方式&lt;/h2&gt;
&lt;h3 id="ipv4-部分"&gt;IPv4 部分&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;添加sing-box-v4路由表&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; /routing table add name=sing-box-v4 fib
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;配置地址列表&lt;/strong&gt;（地址列表中新增proxy_ipv4列表，填入fakeip网段、tg v4网段、奈菲v4网段）：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=28.0.0.0/8
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=1.1.1.1/32
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=1.0.0.1/32
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=8.8.8.8/32
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=8.8.4.4/32
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=8.41.4.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=23.23.189.144/28
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=23.246.0.0/18
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=34.195.253.0/25
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=37.77.184.0/21
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=38.72.126.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=45.57.0.0/17
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=52.24.178.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=52.35.140.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=54.204.25.0/28
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=54.213.167.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=64.120.128.0/17
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=66.197.128.0/17
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=69.53.224.0/19
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=103.87.204.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=108.175.32.0/20
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=185.2.220.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=185.9.188.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=192.173.64.0/18
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=198.38.96.0/19
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=198.45.48.0/20
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=203.75.84.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=203.198.13.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=203.198.80.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=207.45.72.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=208.75.76.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=210.0.153.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.56.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.4.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.8.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.16.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.12.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=149.154.160.0/20
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.105.192.0/23
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=91.108.20.0/22
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=185.76.151.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall address-list add list=proxy_ipv4 address=95.161.64.0/20
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;为目的ip为proxy_ipv4地址列表的连接打上“sing-box-v4”标记&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall mangle add action=mark-routing chain=prerouting dst-address-list=proxy_ipv4 new-routing-mark=sing-box-v4 passthrough=yes
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="4"&gt;
&lt;li&gt;&lt;strong&gt;设置路由表sing-box-v4的下一跳网关为sing-box&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip route add dst-address=0.0.0.0/0 gateway=10.0.0.2 routing-table=sing-box-v4
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="ipv6-部分"&gt;IPv6 部分&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;添加sing-box-v6路由表&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/routing table add name=sing-box-v6 fib
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;&lt;strong&gt;地址列表添加添加fakev6及tg v6网段&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=f2b0::/18 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=2001:b28:f23d::/48 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=2001:b28:f23f::/48 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=2001:67c:4e8::/48 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=2001:b28:f23c::/48 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall address-list add address=2a0a:f280::/32 list=proxy_ipv6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;&lt;strong&gt;为目的ip为proxy_ipv6的连接打标记&lt;/strong&gt;：&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall mangle add action=mark-routing chain=prerouting dst-address-list=proxy_ipv6 new-routing-mark=sing-box-v6
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;设置路由表sing-box-v6的下一跳网关为sing-box。注意gateway为sing-box的IPv6&lt;/strong&gt;：&lt;/p&gt;</description></item><item><title>02.RouterOS开启IPv6并配置防火墙</title><link>https://hanigege.github.io/posts/routers/02.routeros%E5%BC%80%E5%90%AFipv6%E5%B9%B6%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99/</link><pubDate>Fri, 27 Feb 2026 16:32:31 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/02.routeros%E5%BC%80%E5%90%AFipv6%E5%B9%B6%E9%85%8D%E7%BD%AE%E9%98%B2%E7%81%AB%E5%A2%99/</guid><description>&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-markdown" data-lang="markdown"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;本文介绍 RouterOS 如何开启 IPv6。以 &lt;span style="font-weight:bold"&gt;**NAT6**&lt;/span&gt; 模式为例，IPv6 内网网段默认为
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;`dc00::/64`&lt;/span&gt;，RouterOS &lt;span style="color:#e6db74"&gt;`bridge1`&lt;/span&gt; 的 IPv6 内网地址为 &lt;span style="color:#e6db74"&gt;`dc00::1111/64`&lt;/span&gt;。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 桥接接口 &lt;span style="color:#e6db74"&gt;`bridge1`&lt;/span&gt;、拨号接口 &lt;span style="color:#e6db74"&gt;`pppoe-out1`&lt;/span&gt; 名称若不同则自行替换。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; 作者：Tom
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="1-开启-ipv6-模块"&gt;1. 开启 IPv6 模块&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 settings set disable-ipv6=no
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="2-获取-ipv6-前缀-prefix"&gt;2. 获取 IPv6 前缀 (Prefix)&lt;/h2&gt;
&lt;p&gt;从运营商处获取 IPv6 PD：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 dhcp-client add interface=pppoe-out1 pool-name=dhcpv6-gua-pool1 pool-prefix-length=60 request=prefix
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="3-添加局域网-ula-地址池"&gt;3. 添加局域网 ULA 地址池&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 pool add name=dhcpv6-ula-pool1 prefix=dc00::/64 prefix-length=64
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="4-配置接口地址"&gt;4. 配置接口地址&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;计算 EUI-64 地址&lt;/strong&gt;：可使用 &lt;a href="https://eui64-calc.princelle.org/"&gt;EUI-64 计算器&lt;/a&gt;，或直接使用 &lt;code&gt;::1&lt;/code&gt;,或使用上面计算得到的后缀（例如::BF24:12FF:FEE1:E81B）配置pppoe-out1的GUA地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;配置 PPPoE 接口 GUA 地址&lt;/strong&gt;：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 address add address=::BF24:12FF:FEE1:E81B/64 from-pool=dhcpv6-gua-pool1 interface=pppoe-out1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;配置 Bridge 接口 ULA 地址，默认dc00::1111（可自行修改）&lt;/strong&gt;：&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 address add address=dc00::1111/64 from-pool=dhcpv6-ula-pool1 interface=bridge1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="5-开启-nat6-源地址伪装"&gt;5. 开启 NAT6 (源地址伪装)&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ipv6 firewall nat add action=masquerade chain=srcnat src-address=dc00::/64
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="6-配置邻居发现-nd"&gt;6. 配置邻居发现 (ND)&lt;/h2&gt;
&lt;p&gt;禁用默认 ND 配置，并新建配置。建议不广播 IPv6 DNS。&lt;/p&gt;</description></item><item><title>01.RouterOS联网基本配置及IPv4防火墙</title><link>https://hanigege.github.io/posts/routers/01.routeros%E8%81%94%E7%BD%91%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8Aipv4%E9%98%B2%E7%81%AB%E5%A2%99/</link><pubDate>Fri, 27 Feb 2026 16:19:29 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/01.routeros%E8%81%94%E7%BD%91%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE%E5%8F%8Aipv4%E9%98%B2%E7%81%AB%E5%A2%99/</guid><description>&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-markdown" data-lang="markdown"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;本文介绍 RouterOS 拨号、配置 DHCP 服务器、配置 DNS、开启 IPv4 防火墙等通网的基础配置。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;桥接接口 &lt;span style="color:#e6db74"&gt;`bridge1`&lt;/span&gt;、拨号接口 &lt;span style="color:#e6db74"&gt;`pppoe-out1`&lt;/span&gt; 名称若不同则自行替换。
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;作者：Tom
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="1-pppoe-拨号配置"&gt;1. PPPoE 拨号配置&lt;/h2&gt;
&lt;p&gt;手动配置 &lt;code&gt;pppoe-out1&lt;/code&gt; 接口拨号：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;User&lt;/strong&gt;: 填入宽带账号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Password&lt;/strong&gt;: 填入宽带密码&lt;/li&gt;
&lt;li&gt;如果不使用运营商提供的 DNS，可不勾选 &lt;strong&gt;Use Peer DNS&lt;/strong&gt;。
&lt;img src="assets/0.png" alt="0"&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;注&lt;/strong&gt;：接口前出现 “R” 代表拨号成功。拨号成功后建议先禁用，待防火墙配置完毕后再开启！
&lt;img src="assets/2.png" alt="2"&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="2-配置-dhcp-服务器"&gt;2. 配置 DHCP 服务器&lt;/h2&gt;
&lt;p&gt;DHCP IP 范围为 &lt;code&gt;10.0.0.100-10.0.0.250&lt;/code&gt;，网关和 DNS 默认为 ROS。如果希望全局配置透明代理，&lt;code&gt;dns-server&lt;/code&gt; 可配置为 mosdns。&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip pool add name=dhcpv4-pool1 ranges=10.0.0.100-10.0.0.250
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip dhcp-server add name=dhcpv4-server1 interface=bridge1 address-pool=dhcpv4-pool1 lease-time=1d
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip dhcp-server network add address=10.0.0.0/24 gateway=10.0.0.1 dns-server=10.0.0.1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/3.png" alt="3"&gt;
&lt;img src="assets/4.png" alt="4"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="assets/5.png" alt="5"&gt;&lt;/p&gt;
&lt;h2 id="3-配置-dns"&gt;3. 配置 DNS&lt;/h2&gt;
&lt;p&gt;设置 ROS 的上游 DNS，此处先设置 &lt;code&gt;223.5.5.5&lt;/code&gt;，也可自定义填入运营商分配的 DNS。&lt;/p&gt;</description></item><item><title>00.RouterOS初始化及基础配置</title><link>https://hanigege.github.io/posts/routers/00.routeros%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%8A%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/</link><pubDate>Fri, 27 Feb 2026 15:52:26 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/00.routeros%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%8A%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/</guid><description>&lt;hr&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-markdown" data-lang="markdown"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 00.RouterOS 初始化及基础配置
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;作者：Tom
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="第一次进入-routeros"&gt;第一次进入 RouterOS&lt;/h2&gt;
&lt;p&gt;先恢复原厂设置，使用 &lt;strong&gt;Winbox&lt;/strong&gt; 登录（通过 MAC 地址访问后台配置）。&lt;br&gt;
建议先配置防火墙，再开启 PPPoE 接口设置帐号密码联网：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/system reset-configuration
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="确认接口并修改名称"&gt;确认接口并修改名称&lt;/h2&gt;
&lt;p&gt;确认网口功能（区分 lan、wan），并重命名为方便后续操作：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/interface set ether1 name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;lan
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/interface set ether2 name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;wan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/0.png" alt="图例"&gt;&lt;/p&gt;
&lt;h2 id="建立网桥bridge"&gt;建立网桥（Bridge）&lt;/h2&gt;
&lt;p&gt;将所有 LAN 接口添加进桥（bridge）：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/interface bridge add name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;bridge1
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/interface bridge port add bridge&lt;span style="color:#f92672"&gt;=&lt;/span&gt;bridge1 interface&lt;span style="color:#f92672"&gt;=&lt;/span&gt;lan
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/1.png" alt="1"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注：如果双网口，可不建bridge，直接使用lan口，并接入物理交换机。但为方便管理
并为后期vlan等虚拟接口并入bridge做准备，建议建立bridge。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="为-bridge1-和-wan-设置-ip"&gt;为 bridge1 和 wan 设置 IP&lt;/h2&gt;
&lt;p&gt;为bridge1设置IP。本教程以bridge1为例，即ros本机ip为10.0.0.1/24
：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip address add interface&lt;span style="color:#f92672"&gt;=&lt;/span&gt;bridge1 address&lt;span style="color:#f92672"&gt;=&lt;/span&gt;10.0.0.1/24 network&lt;span style="color:#f92672"&gt;=&lt;/span&gt;10.0.0.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/2.png" alt="2"&gt;&lt;/p&gt;
&lt;h2 id="设置时区与-ntp-服务器"&gt;设置时区与 NTP 服务器&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/system clock set time-zone-name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;Asia/Shanghai&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/system clock manual set time-zone&lt;span style="color:#f92672"&gt;=&lt;/span&gt;+08:00
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/system ntp client set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes servers&lt;span style="color:#f92672"&gt;=&lt;/span&gt;cn.pool.ntp.org,ntp1.aliyun.com,time1.cloud.tencent.com
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="关闭所有不需要的服务及端口更改winbox登陆端口为5391可自定义并开启仅允许内网访问注意下方address1000024修改为自己的内网网段"&gt;关闭所有不需要的服务及端口，更改Winbox登陆端口为5391（可自定义），并开启仅允许内网访问，注意下方address=10.0.0.0/24修改为自己的内网网段&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip smb set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip smb shares disable numbers&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip ssh set forwarding-enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip socks set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip upnp set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip proxy set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable api
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable api-ssl
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable ftp
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable ssh
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable telnet
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable www
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service disable www-ssl
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip service set winbox port&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;5391&lt;/span&gt; address&lt;span style="color:#f92672"&gt;=&lt;/span&gt;10.0.0.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/tool bandwidth-server set enabled&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="创建管理员帐号并禁用默认账号"&gt;创建管理员帐号并禁用默认账号&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/user add name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;用户名 password&lt;span style="color:#f92672"&gt;=&lt;/span&gt;密码 group&lt;span style="color:#f92672"&gt;=&lt;/span&gt;full address&lt;span style="color:#f92672"&gt;=&lt;/span&gt;10.0.0.0/24
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="禁用默认账户"&gt;禁用默认账户&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/user disable admin
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;注意：请先确认新创建的用户名和密码可以正常登录，再禁用默认管理员帐号。&lt;/p&gt;</description></item><item><title>Vyos Wireguard Ipv4</title><link>https://hanigege.github.io/posts/routers/vyos-wireguard-ipv4/</link><pubDate>Sun, 01 Jun 2025 20:42:39 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos-wireguard-ipv4/</guid><description>&lt;h1 id="vyos上配置wireguard-ipv4"&gt;vyos上配置wireguard （IPV4）&lt;/h1&gt;
&lt;h2 id="1-生成-wireguard-密钥"&gt;1. 生成 WireGuard 密钥&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;wg genkey | tee privatekey | wg pubkey &amp;gt; publickey
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;• privatekey 文件中存储 私钥&lt;/p&gt;
&lt;p&gt;• publickey 文件中存储 公钥&lt;/p&gt;
&lt;p&gt;然后使用：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cat privatekey
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;把私钥填入 第一步 的 &amp;lt;服务器私钥&amp;gt; 位置。&lt;/p&gt;
&lt;p&gt;配置wireguard:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 address &amp;#39;10.20.30.1/24&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 port &amp;#39;11133&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 private-key &amp;#39;private-key&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 peer iphone allowed-ips &amp;#39;10.20.30.2/32&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 peer iphone public-key &amp;#39;public-key&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set interfaces wireguard wg0 peer iphone preshared-key &amp;#39;preshared-key&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;上面这是添加过peer的。&lt;/p&gt;</description></item><item><title>ROS的MANGLE小包规则</title><link>https://hanigege.github.io/posts/routers/ros%E7%9A%84mangle%E5%B0%8F%E5%8C%85%E8%A7%84%E5%88%99/</link><pubDate>Sun, 11 May 2025 19:23:13 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/ros%E7%9A%84mangle%E5%B0%8F%E5%8C%85%E8%A7%84%E5%88%99/</guid><description>&lt;h2 id="1代码导入的方法"&gt;1、代码导入的方法&lt;/h2&gt;
&lt;p&gt;导入队列的代码：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/queue tree
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add parent&lt;span style="color:#f92672"&gt;=&lt;/span&gt;global packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;dns priority&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; queue&lt;span style="color:#f92672"&gt;=&lt;/span&gt;default-small name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Dns
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add parent&lt;span style="color:#f92672"&gt;=&lt;/span&gt;global packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small-packet priority&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt; queue&lt;span style="color:#f92672"&gt;=&lt;/span&gt;default-small name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;Small-packet
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add parent&lt;span style="color:#f92672"&gt;=&lt;/span&gt;global packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;medium-packet priority&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;2&lt;/span&gt; queue&lt;span style="color:#f92672"&gt;=&lt;/span&gt;default-small name&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;Medium-packet&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/CleanShot%202025-05-11%20at%2019.25.27@2x.png" alt="CleanShot 2025-05-11 at 19.25.27@2x"&gt;&lt;/p&gt;
&lt;p&gt;再导入mangle的代码：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;/ip firewall mangle
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;prerouting protocol&lt;span style="color:#f92672"&gt;=&lt;/span&gt;udp dst-port&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;53&lt;/span&gt; new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;dns passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;prerouting protocol&lt;span style="color:#f92672"&gt;=&lt;/span&gt;tcp dst-port&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;53&lt;/span&gt; new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;dns passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-connection chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;prerouting protocol&lt;span style="color:#f92672"&gt;=&lt;/span&gt;tcp dst-port&lt;span style="color:#f92672"&gt;=&lt;/span&gt;80,443 new-connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;prerouting connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small packet-size&lt;span style="color:#f92672"&gt;=&lt;/span&gt;0-128 new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small-packet passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;prerouting connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small packet-size&lt;span style="color:#f92672"&gt;=&lt;/span&gt;129-512 new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;medium-packet passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;change-mss chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;forward protocol&lt;span style="color:#f92672"&gt;=&lt;/span&gt;tcp tcp-flags&lt;span style="color:#f92672"&gt;=&lt;/span&gt;syn new-mss&lt;span style="color:#f92672"&gt;=&lt;/span&gt;clamp-to-pmtu passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-connection chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;forward protocol&lt;span style="color:#f92672"&gt;=&lt;/span&gt;tcp dst-port&lt;span style="color:#f92672"&gt;=&lt;/span&gt;80,443 new-connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;yes
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;forward connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small packet-size&lt;span style="color:#f92672"&gt;=&lt;/span&gt;0-128 new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small-packet passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;add action&lt;span style="color:#f92672"&gt;=&lt;/span&gt;mark-packet chain&lt;span style="color:#f92672"&gt;=&lt;/span&gt;forward connection-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;small packet-size&lt;span style="color:#f92672"&gt;=&lt;/span&gt;129-512 new-packet-mark&lt;span style="color:#f92672"&gt;=&lt;/span&gt;medium-packet passthrough&lt;span style="color:#f92672"&gt;=&lt;/span&gt;no
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src="assets/CleanShot%202025-05-11%20at%2019.26.58@2x.png" alt="CleanShot 2025-05-11 at 19.26.58@2x"&gt;&lt;/p&gt;</description></item><item><title>Vyos下安装ddns-Go</title><link>https://hanigege.github.io/posts/routers/vyos%E4%B8%8B%E5%AE%89%E8%A3%85ddns-go/</link><pubDate>Sun, 11 May 2025 14:51:24 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos%E4%B8%8B%E5%AE%89%E8%A3%85ddns-go/</guid><description>&lt;br&gt;
&lt;h2 id="这里使用vyos自管理容器的方法可以获取到网卡公网ip"&gt;这里使用vyos自管理容器的方法,可以获取到网卡公网ip&lt;/h2&gt;
&lt;h3 id="操作前vyos本机先科学不然没法接docker镜像"&gt;操作前，vyos本机先科学，不然没法接docker镜像&lt;/h3&gt;
&lt;p&gt;    这种模式不可以设置单独的IP,因为使用的是vyos主机的ip&lt;/p&gt;
&lt;p&gt;    桥接的网络如果没有，可以建一个的：原因是方便 ddns-go使用内网的网址登录 ：172.23.0.1 (可选，非必须，也可以用内外网口ip登录)&lt;/p&gt;
&lt;h2 id="创建桥接网络"&gt;创建桥接网络&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container network ct-network prefix &lt;span style="color:#e6db74"&gt;&amp;#39;172.23.0.0/24&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="提前建立好ddns的映射本地持久目录"&gt;提前建立好ddns的映射本地持久目录：&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir -p /config/containers/ddns
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="拉取容器镜像"&gt;拉取容器镜像&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;$ add container image &lt;span style="color:#e6db74"&gt;&amp;#39;jeessy/ddns-go&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="搭建ddns-go"&gt;搭建ddns-go&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container name ddns-go allow-host-networks &lt;span style="color:#75715e"&gt;#允许容器使用主机网络（host network），也就是说，容器不会有独立的网络接口，而是直接使用 VyOS 主机的网络&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container name ddns-go image &lt;span style="color:#e6db74"&gt;&amp;#39;docker.io/jeessy/ddns-go&amp;#39;&lt;/span&gt; &lt;span style="color:#75715e"&gt;#指定该容器使用的 Docker 镜像&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container name ddns-go restart &lt;span style="color:#e6db74"&gt;&amp;#39;always&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container name ddns-go volume config destination &lt;span style="color:#e6db74"&gt;&amp;#39;/root/&amp;#39;&lt;/span&gt; &lt;span style="color:#75715e"&gt;#映射容器内的路径&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set container name ddns-go volume config source &lt;span style="color:#e6db74"&gt;&amp;#39;/config/containers/ddns&amp;#39;&lt;/span&gt; &lt;span style="color:#75715e"&gt;#映射本地的路役&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="查看运行是否成功有up即成功"&gt;查看运行是否成功有UP即成功&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo podman ps -s
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo podman ps -a
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="登录管理平台"&gt;登录管理平台&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;http://IP:9876
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;登录用户名：admin&lt;/p&gt;</description></item><item><title>Sing-Box中的ss服务的写法配置</title><link>https://hanigege.github.io/posts/routers/sing-box-ss-server/</link><pubDate>Sun, 11 May 2025 12:07:27 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/sing-box-ss-server/</guid><description>&lt;h2 id="服务端"&gt;服务端：&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;shadowsocks&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;listen&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;::&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;listen_port&amp;#34;&lt;/span&gt;: 58442,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;method&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;chacha20-ietf-poly1305&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;password&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;Um5zktQDo6GKqM1L/lLzwg==&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;multiplex&amp;#34;&lt;/span&gt;: &lt;span style="color:#f92672"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;enabled&amp;#34;&lt;/span&gt;: true
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="客户端"&gt;客户端：&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;type&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;shadowsocks&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;tag&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;ss-in-jygg-ros&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;server&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;你的域名.xyz&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;server_port&amp;#34;&lt;/span&gt;: 58442,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;network_strategy&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;hybrid&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;method&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;chacha20-ietf-poly1305&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;password&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;Um5zktQDo6GKqM1L/lLzwg==&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;udp_over_tcp&amp;#34;&lt;/span&gt;: false
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Vyos上网系统之-vyos命令技巧集(3)</title><link>https://hanigege.github.io/posts/routers/vyos-jiqiao-3/</link><pubDate>Sat, 10 May 2025 21:35:04 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos-jiqiao-3/</guid><description>&lt;h2 id="你可以使用-delete-和-set-命令来修改-network-group-的子网"&gt;你可以使用 delete 和 set 命令来修改 network-group 的子网。&lt;/h2&gt;
&lt;p&gt;修改 LAN-v4 的网络&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;删除原来的 192.168.10.0/24&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;delete firewall group network-group LAN-v4 network 192.168.10.0/24
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="2"&gt;
&lt;li&gt;添加新的 192.168.100.0/24&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group LAN-v4 network 192.168.100.0/24
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;提交并保存&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;commit
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;验证修改是否生效&lt;/p&gt;
&lt;p&gt;执行以下命令：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;show firewall group network-group LAN-v4
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;如果输出如下，就说明修改成功：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; network-group LAN-v4 {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; network 192.168.100.0/24
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在 VyOS 中，你可以使用以下命令查看 所有配置：
显示完整的层级配置（推荐）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;show configuration
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这个命令会以 层级结构 显示整个配置，类似于 show running-config。&lt;/p&gt;
&lt;p&gt;显示所有配置命令（适合复制）($ 模式下）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;show configuration commands
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;这个命令会以 show 命令的格式 展示所有配置，适用于备份或复制配置：&lt;/p&gt;</description></item><item><title>Vyos上网系列之-Fakeip配置(2)</title><link>https://hanigege.github.io/posts/routers/vyos-fakeip-2/</link><pubDate>Sat, 10 May 2025 21:25:08 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos-fakeip-2/</guid><description>&lt;h2 id="对于终端网关是vyos的通过mosdns来分流realip和fakeip的流量-可这样配置"&gt;对于终端网关是vyos的，通过mosdns来分流realip和fakeip的流量, 可这样配置:&lt;/h2&gt;
&lt;p&gt;(vyos的group分为address-group,network-group等)&lt;/p&gt;
&lt;h4 id="定义组-ip例"&gt;定义组 IP例:&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group address-group Telegram-v4 address &amp;#39;157.148.47.204&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group address-group Telegram-v4 address &amp;#39;182.43.124.6&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="定义组网段v4例"&gt;定义组网段V4例：&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.56.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.4.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;定义组telegram V4:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.56.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.4.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.8.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.16.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.12.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;149.154.160.0/20&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.105.192.0/23&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.20.0/22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group network-group Telegram-v4 network &amp;#39;185.76.151.0/24&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h4 id="定义组ip-v6例"&gt;定义组ip-V6例：&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group ipv6-address-group Telegram-v6 address &amp;#39;2a00:1098:80:2::1004&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set firewall group ipv6-address-group Telegram-v6 address &amp;#39;2a00:1098:80:2::1001&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;定义组网段V6例：&lt;/p&gt;</description></item><item><title>Vyos上网系列之-上网配置（1）</title><link>https://hanigege.github.io/posts/routers/vyos-jibenshangwang-1/</link><pubDate>Sat, 10 May 2025 21:04:17 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos-jibenshangwang-1/</guid><description>&lt;h4 id="vyos的命令行界面是基于shell的没有图形界面-但是可以用tab自动补全"&gt;vyos的命令行界面是基于shell的，没有图形界面, 但是可以用tab自动补全.&lt;/h4&gt;
&lt;p&gt;本文的vyos命令是基于vyos的vyos-rolling-nightly-builds的1.5.x版本.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;**特别感谢大卫佬给予的指导与帮助**&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="pve安装vyos"&gt;pve安装vyos:&lt;/h2&gt;
&lt;p&gt;下载nightly-build: &lt;a href="https://github.com/vyos/vyos-nightly-build/releases"&gt;https://github.com/vyos/vyos-nightly-build/releases&lt;/a&gt;
pve的虚拟机设置和安装(略), 建议内存2G, 磁盘10G或更大, 因为vyos可以运行容器, vyos用podman管理容器.&lt;/p&gt;
&lt;p&gt;vm运行后, 用vyos:vyos登录. 用命令&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;install image
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;安装vyos.&lt;/p&gt;
&lt;p&gt;进入配置模式：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;configure
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;生效：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;commit
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;保存配置：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;save
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;取消生效的,未保存的配置：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;discard
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="下面开始配置随时都可以输入生效命令如果不保存重启后配置会失效"&gt;下面开始配置，随时都可以输入生效命令，如果不保存，重启后配置会失效&lt;/h2&gt;
&lt;p&gt;设置ssh登录:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set service ssh port &amp;#39;22&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;创建用户gary:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set system login user gary full-name gary
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set system login user gary authentication plaintext-password &amp;#39;密码&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;建议ssh密钥登录:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set system login user gary authentication public-keys gary@laptop key &amp;#39;your-public-key&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;set system login user gary authentication public-keys gary@laptop type &amp;#39;ssh-rsa&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;禁用默认的vyos用户:&lt;/p&gt;</description></item><item><title>RosIPV6配置方案</title><link>https://hanigege.github.io/posts/routers/ros-ipv6-set/</link><pubDate>Thu, 08 May 2025 20:37:25 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/ros-ipv6-set/</guid><description>&lt;h2 id="ipv6最终配置定型"&gt;ipv6最终配置定型：&lt;/h2&gt;</description></item><item><title>vyos多网口小主机桥接配置(完整)</title><link>https://hanigege.github.io/posts/routers/vyos-qiaojie-4kou/</link><pubDate>Wed, 07 May 2025 23:30:18 +0800</pubDate><guid>https://hanigege.github.io/posts/routers/vyos-qiaojie-4kou/</guid><description>&lt;h3 id="一基本上网配置"&gt;一.基本上网配置&lt;/h3&gt;
&lt;h3 id="vyos的命令行界面是基于shell的没有图形界面-但是可以用tab自动补全"&gt;vyos的命令行界面是基于shell的，没有图形界面, 但是可以用tab自动补全&lt;/h3&gt;
&lt;p&gt;本文的vyos命令是基于vyos的vyos-rolling-nightly-builds的1.5.x版本.&lt;/p&gt;</description></item></channel></rss>