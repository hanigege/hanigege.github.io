<!doctype html><html lang=zh><head><title>Freebsd-Ipfirewall(IPFW)é˜²ç«å¢™ä»‹ç» &ndash; bash</title><meta name=description content="å€‹äººè‡ªç•™åœ°ï¼Œå¦‚æœèƒ½å¹«åˆ°ä½ ï¼Œæˆ‘ä¹Ÿæœƒå¾ˆé«˜èˆˆã€‚"><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://hanigege.github.io/css/palettes/base16-dark.css><link rel=stylesheet href=https://hanigege.github.io/css/risotto.css><link rel=stylesheet href=https://hanigege.github.io/css/custom.css><script src=https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js></script><style>pre{position:relative;padding-top:40px!important;background-color:#1e1e1e!important;border:1px solid #333!important;border-radius:10px!important;box-shadow:0 4px 15px rgba(0,0,0,.4);overflow-x:auto!important;overflow-y:hidden!important;margin:1.5em 0}pre::-webkit-scrollbar{height:8px}pre::-webkit-scrollbar-thumb{background:#4a4a4a;border-radius:4px}pre::-webkit-scrollbar-track{background:0 0}code{font-family:jetbrains mono,fira code,Menlo,monospace!important;font-size:.92em!important;line-height:1.6!important;color:#d4d4d4!important;background:0 0!important;white-space:pre!important}.copy-code-button{position:absolute;top:10px;right:12px;padding:5px 12px;background:rgba(255,255,255,8%);color:#aaa;border:1px solid rgba(255,255,255,.15);border-radius:6px;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);cursor:pointer;font-size:11px;font-weight:500;z-index:100;transition:all .25s ease}.copy-code-button:hover{background:rgba(102,217,239,.2);color:#66d9ef;border-color:#66d9ef;transform:translateY(-1px)}.copy-code-button:active{transform:translateY(0)}p img{cursor:zoom-in;transition:opacity .3s;border-radius:4px;max-width:100%}p img:hover{opacity:.9}.medium-zoom-overlay{z-index:999998!important}.medium-zoom-image--opened{z-index:999999!important}</style><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("pre").forEach(e=>{if(e.querySelector(".copy-code-button"))return;const t=document.createElement("button");t.className="copy-code-button",t.type="button",t.innerText="Copy",t.addEventListener("click",()=>{const n=e.querySelector("code"),s=n?n.innerText:e.innerText;navigator.clipboard.writeText(s).then(()=>{t.innerText="Copied!",t.style.background="rgba(166, 226, 46, 0.2)",t.style.color="#a6e22e",setTimeout(()=>{t.innerText="Copy",t.style.background="",t.style.color=""},2e3)})}),e.appendChild(t)});const e=document.querySelectorAll("p img");e.length>0&&mediumZoom(e,{margin:24,background:"#1e1e1ecf",scrollOffset:40})})</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><link rel=stylesheet href=/css/custom.css><ul><li class=nomarker><h1 class=page__logo><a href=https://hanigege.github.io/ class=page__logo-inner>bash</a></h1></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/freebsd/ title>FreeBSD</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/linux/ title>Linux</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/routers/ title>Routers</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/other/ title>Other</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/about/ title>About</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>Freebsd-Ipfirewall(IPFW)é˜²ç«å¢™ä»‹ç»</h1></header><div class=content__body><h4 id=ipfirewall-ipfwip-é˜²ç«å¢™-æ˜¯ä¸€æ¬¾ç”±-freebsd-å‘èµ·çš„é˜²ç«å¢™åº”ç”¨è½¯ä»¶å®ƒç”±-freebsd-é¡¹ç›®ç¼–å†™å’Œç»´æŠ¤>IPFIREWALL (IPFWï¼ŒIP é˜²ç«å¢™) æ˜¯ä¸€æ¬¾ç”± FreeBSD å‘èµ·çš„é˜²ç«å¢™åº”ç”¨è½¯ä»¶ï¼Œå®ƒç”± FreeBSD é¡¹ç›®ç¼–å†™å’Œç»´æŠ¤ã€‚</h4><p>ipfw åœ¨åŸºæœ¬ç³»ç»Ÿçš„å†…æ ¸ï¼ˆGENERICï¼‰ä½œä¸ºå¯åŠ è½½æ¨¡å—è€Œå­˜åœ¨ã€‚</p><h1 id=è­¦å‘Š><code>è­¦å‘Š</code></h1><p>IPFW é»˜è®¤ä¼šæœ‰ä¸€æ¡è§„åˆ™ï¼Œè§„åˆ™å·ä¸º <code>65535</code>ï¼Œæ˜¯ä¸å¯ä»¥åˆ é™¤çš„ï¼šè¿™æ¡è§„åˆ™ä¼šæŠŠæ‰€æœ‰æµé‡éƒ½åˆ‡æ–­ã€‚æ•…åœ¨æœªé…ç½®å¥½é˜²ç«å¢™å‰ï¼Œè¯·å‹¿å¯åŠ¨ IPFWï¼Œå¦åˆ™å°±ä¼šé¢ä¸´è¢«é˜»æŒ¡åœ¨é˜²ç«å¢™ä¹‹å¤–çš„éº»çƒ¦ã€‚</p><h2 id=æœåŠ¡é¡¹>æœåŠ¡é¡¹</h2><p>å¼€æœºè‡ªåŠ¨å¯åŠ¨é˜²ç«å¢™ç›¸åº”çš„å†…æ ¸æ¨¡å—ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sysrc firewall_enable=&#34;YES&#34;</span>
</span></span></code></pre></div><p>å‚è§ <a href=https://github.com/freebsd/freebsd-src/blob/main/libexec/rc/rc.d/routing#L387>å®˜æ–¹ç½‘å€</a></p><p>æˆ–è€…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># service ipfw enable # é¡»é‡å¯åç”Ÿæ•ˆ</span>
</span></span></code></pre></div><p>ä¿å­˜æ‰€éœ€ç¼–è¾‘åï¼Œå¯åŠ¨é˜²ç«å¢™ã€‚è¦ç«‹å³å¯ç”¨æ—¥å¿—è®°å½•é™åˆ¶ï¼Œè¿˜è¯·è®¾ç½®sysctlä¸Šé¢æŒ‡å®šçš„å€¼ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># service ipfw start</span>
</span></span></code></pre></div><p>å¯åŠ¨ ipfwï¼šï¼ˆå¯åŠ¨å‰éœ€è¦å…ˆæ·»åŠ æ”¾å¼€22ç«¯å£çš„è§„åˆ™ï¼Œå…ˆæ‰§è¡Œä¸‹é¢çš„ï¼‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># service ipfw start</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Firewall rules loaded.
</span></span><span style=display:flex><span>Firewall logging enabled.
</span></span><span style=display:flex><span>ifconfig: interface ipfw0 already exists
</span></span><span style=display:flex><span>Firewall logging pseudo-interface <span style=color:#f92672>(</span>ipfw0<span style=color:#f92672>)</span> created.
</span></span></code></pre></div><p>æŸ¥çœ‹ ipfw çŠ¶æ€ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># service ipfw status</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ipfw is enabled
</span></span></code></pre></div><p>å…¶ä»– RC é…ç½®</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sysrc firewall_type=&#34;open&#34;  # å…è®¸ä»»ä½•è®¿é—®ã€‚å¦‚æœä¸è¿™ä¹ˆåšï¼Œä¼šè°ƒç”¨é»˜è®¤è§„åˆ™ 65535â€”â€”deny ip from any to anyï¼Œæ‹’ç»æ‰€æœ‰ IPã€‚ä½ å°±åªèƒ½å»ç‰©ç†æœºä¸Šå†æ“ä½œäº†ã€‚åŸºæœ¬ç­‰åŒäº net.inet.ip.fw.default_to_accept=&#34;1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sysrc firewall_script=&#34;/usr/local/etc/ipfw.rules&#34;  # æŒ‡å®š ipfw è§„åˆ™çš„è·¯å¾„ï¼Œåœ¨æ­¤å¤„ç¼–è¾‘è§„åˆ™</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sysrc firewall_logging=&#34;YES&#34;  # è¿™æ · ipfw å°±å¯ä»¥æ‰“å°æ—¥å¿—</span>
</span></span><span style=display:flex><span><span style=color:#75715e># sysrc firewall_logif=&#34;YES&#34;  # æŠŠæ—¥å¿—æ‰“å°åˆ° `ipfw0` è¿™ä¸ªè®¾å¤‡é‡Œ</span>
</span></span></code></pre></div><p><code>sysrc firewall_type="open"</code> è®¾ç½®åä¸ä¼šç›´æ¥å†™å…¥ allow ip from any to any åˆ°é…ç½®æ–‡ä»¶ã€‚</p><p><code>ç»æµ‹è¯•ï¼Œèƒ½æ§åˆ¶é˜²ç«å¢™å…¨å¼€æ”¾æ˜¯</code>ï¼š</p><p>ä½ æŠŠ<code>net.inet.ip.fw.default_to_accept=1</code>æ”¾åˆ°<code>/boot/loader.conf</code>é‡å¯æ‰èƒ½ç”Ÿæ•ˆ ï¼Œæ‰‹åŠ¨æ”¹æ–‡ä»¶æ”¾è¿›å»ã€‚ç„¶åé‡å¯ç³»ç»Ÿæ‰èƒ½ç”Ÿæ•ˆï¼Œä¼šåœ¨é…ç½®æ–‡ä»¶é‡Œç”Ÿæˆï¼š<code>allow ip from any to any </code># æ³¨æ„æ­¤å¤„</p><p>æˆ–è€…ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sysctl net.inet.ip.fw.default_to_accept<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>ä½†ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šåŠ è½½ç­‰æ•ˆçš„è§„åˆ™ï¼Œä½œç”¨å°±æ˜¯å®Œå…¨å¼€æ”¾é˜²ç«å¢™ã€‚</p><p>æŒ‰ä¸Šé¢çš„é…ç½®åçš„è§„åˆ™ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ipfw list</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>00100</span> allow ip from any to any via lo0
</span></span><span style=display:flex><span><span style=color:#ae81ff>00200</span> deny ip from any to 127.0.0.0/8
</span></span><span style=display:flex><span><span style=color:#ae81ff>00300</span> deny ip from 127.0.0.0/8 to any
</span></span><span style=display:flex><span><span style=color:#ae81ff>00400</span> deny ip from any to ::1
</span></span><span style=display:flex><span><span style=color:#ae81ff>00500</span> deny ip from ::1 to any
</span></span><span style=display:flex><span><span style=color:#ae81ff>00600</span> allow ipv6-icmp from :: to ff02::/16
</span></span><span style=display:flex><span><span style=color:#ae81ff>00700</span> allow ipv6-icmp from fe80::/10 to fe80::/10
</span></span><span style=display:flex><span><span style=color:#ae81ff>00800</span> allow ipv6-icmp from fe80::/10 to ff02::/16
</span></span><span style=display:flex><span><span style=color:#ae81ff>00900</span> allow ipv6-icmp from any to any icmp6types <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01000</span> allow ipv6-icmp from any to any icmp6types 2,135,136
</span></span><span style=display:flex><span><span style=color:#ae81ff>65000</span> allow ip from any to any <span style=color:#75715e># æ³¨æ„æ­¤å¤„</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>65535</span> deny ip from any to any
</span></span></code></pre></div><h2 id=ç¼–è¾‘-usrlocaletcipfwrules-æ–‡ä»¶>ç¼–è¾‘ /usr/local/etc/ipfw.rules æ–‡ä»¶</h2><p>æŒ‡å®šé˜²ç«å¢™è§„åˆ™ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ipfw -q -f flush <span style=color:#75715e># -q é€‰é¡¹è¡¨ç¤ºé™é»˜æ¨¡å¼ï¼Œé¿å…è¾“å‡ºå†—ä½™ä¿¡æ¯, åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰æ¸…é™¤åˆ—è¡¨ã€‚</span>
</span></span><span style=display:flex><span>cmd<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ipfw -q add&#34;</span> <span style=color:#75715e># â€‹å®šä¹‰ä¸€ä¸ªå˜é‡ cmdï¼Œç”¨äºç®€åŒ–åç»­æ·»åŠ è§„åˆ™çš„å‘½ä»¤ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># loopback</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>10</span> allow all from any to any via lo0 <span style=color:#75715e># å…è®¸æ‰€æœ‰é€šè¿‡å›ç¯æ¥å£ lo0 çš„æµé‡ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>20</span> deny all from any to 127.0.0.0/8 <span style=color:#75715e># æ‹’ç»ä»»ä½•è¯•å›¾è®¿é—®æœ¬åœ°å›ç¯åœ°å€èŒƒå›´ï¼ˆ127.0.0.0/8ï¼‰çš„å¤–éƒ¨æµé‡ï¼Œé˜²æ­¢ä¼ªé€ çš„å›ç¯åœ°å€é€šä¿¡ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>30</span> deny all from 127.0.0.0/8 to any <span style=color:#75715e># æ‹’ç»æ¥è‡ªå›ç¯åœ°å€èŒƒå›´çš„ä»»ä½•æµé‡ç¦»å¼€æœ¬åœ°ä¸»æœºï¼Œè¿›ä¸€æ­¥ç¡®ä¿å›ç¯åœ°å€çš„å®‰å…¨æ€§ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>40</span> deny tcp from any to any frag <span style=color:#75715e># â€‹æ‹’ç»æ‰€æœ‰åˆ†ç‰‡çš„ TCP æ•°æ®åŒ…ï¼Œæœ‰åŠ©äºé˜²èŒƒæŸäº›ç±»å‹çš„æ”»å‡»ã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># statefull</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>50</span> check-state <span style=color:#75715e># æ£€æŸ¥ç°æœ‰çš„ä¼šè¯çŠ¶æ€ï¼Œå…è®¸å·²å»ºç«‹çš„ä¼šè¯ç»§ç»­é€šä¿¡ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>60</span> allow tcp from any to any established <span style=color:#75715e># å…è®¸æ‰€æœ‰å·²å»ºç«‹çš„ TCP è¿æ¥çš„æ•°æ®åŒ…é€šè¿‡ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>70</span> allow all from any to any out keep-state <span style=color:#75715e># å…è®¸æ‰€æœ‰å‘å¤–çš„æµé‡ï¼Œå¹¶å¯¹å…¶åˆ›å»ºçŠ¶æ€è®°å½•ï¼Œä»¥ä¾¿å“åº”æµé‡èƒ½å¤Ÿè‡ªåŠ¨é€šè¿‡ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>80</span> allow icmp from any to any <span style=color:#75715e># å…è®¸æ‰€æœ‰ ICMP æ•°æ®åŒ…ï¼Œæ”¯æŒç½‘ç»œè¯Šæ–­å’Œé”™è¯¯æŠ¥å‘ŠåŠŸèƒ½ã€‚â€‹</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># open port for ssh</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>110</span> allow tcp from any to any <span style=color:#ae81ff>22</span> out <span style=color:#75715e># å…è®¸æ‰€æœ‰å‘å¤–çš„ SSH æµé‡</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>120</span> allow tcp from any to any <span style=color:#ae81ff>22</span> in <span style=color:#75715e># ç¡®ä¿å¯ä»¥é€šè¿‡ SSH è®¿é—®è¯¥ä¸»æœºã€‚</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># open port for samba # å…è®¸ä¸ Samba æ–‡ä»¶å…±äº«æœåŠ¡ç›¸å…³çš„ç«¯å£ï¼ˆ137-139 å’Œ 445ï¼‰çš„è¿›å‡ºæµé‡ï¼Œç¡®ä¿ Samba æœåŠ¡æ­£å¸¸è¿è¡Œã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>130</span> allow tcp from any to any <span style=color:#ae81ff>139</span> out
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>140</span> allow tcp from any to any <span style=color:#ae81ff>139</span> in
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>150</span> allow tcp from any to any <span style=color:#ae81ff>445</span> out
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>160</span> allow tcp from any to any <span style=color:#ae81ff>445</span> in
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>170</span> allow udp from any to any <span style=color:#ae81ff>137</span> out
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>180</span> allow udp from any to any <span style=color:#ae81ff>137</span> in
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>190</span> allow udp from any to any <span style=color:#ae81ff>138</span> out
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>200</span> allow udp from any to any <span style=color:#ae81ff>138</span> in
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># deny and log everything # æ‹’ç»æ‰€æœ‰æœªæ˜ç¡®å…è®¸çš„æµé‡ï¼Œå¹¶å°†å…¶è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œä¾¿äºå®¡è®¡å’Œæ•…éšœæ’æŸ¥ã€‚</span>
</span></span><span style=display:flex><span>$cmd <span style=color:#ae81ff>500</span> deny log all from any to any
</span></span></code></pre></div><p>æ¯ä¸€æ¡è§„åˆ™çš„ç»“æ„åŸºæœ¬éƒ½æ˜¯ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ipfw add [è§„åˆ™ç¼–å·] â‘  [åŠ¨ä½œ] [åè®®] from [æºåœ°å€] to [ç›®æ ‡åœ°å€] [å…¶ä»–æ¡ä»¶]</span>
</span></span></code></pre></div><p>â‘  æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œå¯ä¼˜å…ˆè¦†ç›–ç›¸åŒçš„ã€æ•°å­—å¤§çš„è§„åˆ™ã€‚</p><p><code>$cmd 500 deny log all from any to any â€”â€”> ipfw add 500 deny log all from any to any</code></p><h2 id=æ³¨æ„>æ³¨æ„</h2><p>`ipfw å‘½ä»¤æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå®ƒä¼šåœ¨æ‰§è¡Œæ—¶å³æ—¶ç”Ÿæ•ˆï¼Œä½†ä¸ä¼šæ°¸ä¹…ä¿å­˜è§„åˆ™ã€‚ä½ é¡»å†™å…¥æŒ‡å®šçš„è§„åˆ™æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠé»˜è®¤æ‹’ç»çš„è§„åˆ™ 65535 deny ip from any to any æ”¹æˆé»˜è®¤å…è®¸`</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># echo net.inet.ip.fw.default_to_accept=&#34;1&#34; &gt;&gt; /boot/loader.conf</span>
</span></span></code></pre></div><h2 id=æŸ¥çœ‹-ipfw-è§„åˆ™>æŸ¥çœ‹ ipfw è§„åˆ™</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ipfw list</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>00100</span> allow ip from any to any via lo0
</span></span><span style=display:flex><span><span style=color:#ae81ff>00200</span> deny ip from any to 127.0.0.0/8
</span></span><span style=display:flex><span><span style=color:#ae81ff>00300</span> deny ip from 127.0.0.0/8 to any
</span></span><span style=display:flex><span><span style=color:#ae81ff>00400</span> deny ip from any to ::1
</span></span><span style=display:flex><span><span style=color:#ae81ff>00500</span> deny ip from ::1 to any
</span></span><span style=display:flex><span><span style=color:#ae81ff>00600</span> allow ipv6-icmp from :: to ff02::/16
</span></span><span style=display:flex><span><span style=color:#ae81ff>00700</span> allow ipv6-icmp from fe80::/10 to fe80::/10
</span></span><span style=display:flex><span><span style=color:#ae81ff>00800</span> allow ipv6-icmp from fe80::/10 to ff02::/16
</span></span><span style=display:flex><span><span style=color:#ae81ff>00900</span> allow ipv6-icmp from any to any icmp6types <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>01000</span> allow ipv6-icmp from any to any icmp6types 2,135,136
</span></span><span style=display:flex><span><span style=color:#ae81ff>65535</span> allow ip from any to any <span style=color:#75715e># æ³¨æ„æ­¤å¤„æ˜¯é»˜è®¤å…è®¸äº†ï¼Œåé¢æ²¡äº†</span>
</span></span></code></pre></div><div id=utterances-comments><script src=https://utteranc.es/client.js repo=hanigege/blog-comments issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div class=aside__about><span class=about__logo role=img>ğŸš</span>&nbsp;<h1 class=about__title>root</h1><p class=about__description>å€‹äººè‡ªç•™åœ°ï¼Œå¦‚æœèƒ½å¹«åˆ°ä½ ï¼Œæˆ‘ä¹Ÿæœƒå¾ˆé«˜èˆˆã€‚</p></div><ul class=aside__social-links><li><a href=mailto:purodn@gmail.com rel=me aria-label=Email title=Email><i class="fa-solid fa-envelope" aria-hidden=true></i></a>&nbsp;</li></ul></div><hr><div class=aside__content><p>2025-05-12</p><hr>On this page:<nav id=TableOfContents><ol><li><ol><li></li></ol></li></ol><ol><li><a href=#æœåŠ¡é¡¹>æœåŠ¡é¡¹</a></li><li><a href=#ç¼–è¾‘-usrlocaletcipfwrules-æ–‡ä»¶>ç¼–è¾‘ /usr/local/etc/ipfw.rules æ–‡ä»¶</a></li><li><a href=#æ³¨æ„>æ³¨æ„</a></li><li><a href=#æŸ¥çœ‹-ipfw-è§„åˆ™>æŸ¥çœ‹ ipfw è§„åˆ™</a></li></ol></nav></div></section><footer class=page__footer><p class=copyright>Â© <strong>felix</strong>.</p><p class=advertisement>Powered by <a>bash&sh</a>.</p></footer></div></body></html>