<!doctype html><html lang=zh><head><title>05.RouterOSå¦‚ä½•natå›æµåŠåŒ…å«é…å¥—é˜²ç«å¢™è§„åˆ™ &ndash; bash</title><meta name=description content="å€‹äººè‡ªç•™åœ°ï¼Œå¦‚æœèƒ½å¹«åˆ°ä½ ï¼Œæˆ‘ä¹Ÿæœƒå¾ˆé«˜èˆˆã€‚"><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://hanigege.github.io/css/palettes/base16-dark.css><link rel=stylesheet href=https://hanigege.github.io/css/risotto.css><link rel=stylesheet href=https://hanigege.github.io/css/custom.css><script src=https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js></script><style>pre{position:relative;padding-top:40px!important;background-color:#1e1e1e!important;border:1px solid #333!important;border-radius:10px!important;box-shadow:0 4px 15px rgba(0,0,0,.4);overflow-x:auto!important;overflow-y:hidden!important;margin:1.5em 0}pre::-webkit-scrollbar{height:8px}pre::-webkit-scrollbar-thumb{background:#4a4a4a;border-radius:4px}pre::-webkit-scrollbar-track{background:0 0}code{font-family:jetbrains mono,fira code,Menlo,monospace!important;font-size:.92em!important;line-height:1.6!important;color:#d4d4d4!important;background:0 0!important;white-space:pre!important}.copy-code-button{position:absolute;top:10px;right:12px;padding:5px 12px;background:rgba(255,255,255,8%);color:#aaa;border:1px solid rgba(255,255,255,.15);border-radius:6px;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px);cursor:pointer;font-size:11px;font-weight:500;z-index:100;transition:all .25s ease}.copy-code-button:hover{background:rgba(102,217,239,.2);color:#66d9ef;border-color:#66d9ef;transform:translateY(-1px)}.copy-code-button:active{transform:translateY(0)}p img{cursor:zoom-in;transition:opacity .3s;border-radius:4px;max-width:100%}p img:hover{opacity:.9}.medium-zoom-overlay{z-index:999998!important}.medium-zoom-image--opened{z-index:999999!important}</style><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("pre").forEach(e=>{if(e.querySelector(".copy-code-button"))return;const t=document.createElement("button");t.className="copy-code-button",t.type="button",t.innerText="Copy",t.addEventListener("click",()=>{const n=e.querySelector("code"),s=n?n.innerText:e.innerText;navigator.clipboard.writeText(s).then(()=>{t.innerText="Copied!",t.style.background="rgba(166, 226, 46, 0.2)",t.style.color="#a6e22e",setTimeout(()=>{t.innerText="Copy",t.style.background="",t.style.color=""},2e3)})}),e.appendChild(t)});const e=document.querySelectorAll("p img");e.length>0&&mediumZoom(e,{margin:24,background:"#1e1e1ecf",scrollOffset:40})})</script></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><link rel=stylesheet href=/css/custom.css><ul><li class=nomarker><h1 class=page__logo><a href=https://hanigege.github.io/ class=page__logo-inner>bash</a></h1></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/freebsd/ title>FreeBSD</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/linux/ title>Linux</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/routers/ title>Routers</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/categories/other/ title>Other</a></li><li class=main-nav__item><a class=nav-main-item href=https://hanigege.github.io/about/ title>About</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>05.RouterOSå¦‚ä½•natå›æµåŠåŒ…å«é…å¥—é˜²ç«å¢™è§„åˆ™</h1></header><div class=content__body><h2 id=å†…ç½‘çš„dst-natè¦åŠ å¤–ç½‘æ¥å£å¦‚pppoe-out1>å†…ç½‘çš„dst-natè¦åŠ å¤–ç½‘æ¥å£å¦‚pppoe-out1</h2><h2 id=1-ä¸ºä»€ä¹ˆéœ€è¦å›æµ>1. ä¸ºä»€ä¹ˆéœ€è¦å›æµï¼Ÿ</h2><p>å½“ä½ ä»å†…ç½‘è¯·æ±‚å…¬ç½‘ IP æ—¶ï¼ŒROS æ”¶åˆ°åŒ…åè½¬å‘ç»™å†…ç½‘æœåŠ¡å™¨ï¼Œä½†æœåŠ¡å™¨å‘ç°è¯·æ±‚æ–¹å’Œè‡ªå·±åœ¨åŒä¸€ä¸ªç½‘æ®µï¼Œä¼šç›´æ¥æŠŠå›åŒ…ä¼ ç»™æ‰‹æœºã€‚æ‰‹æœºå‘ç°è‡ªå·±å‘ç»™å…¬ç½‘ IP çš„è¯·æ±‚å´æ”¶åˆ°äº†æ¥è‡ªå†…ç½‘ç§æœ‰ IP çš„å“åº”ï¼Œä¼šå› ä¸ºå®‰å…¨æœºåˆ¶ç›´æ¥ä¸¢å¼ƒè¯¥åŒ…ã€‚å›æµè§„åˆ™é€šè¿‡è®© ROS ä¸­è½¬è¿™ä¸ªâ€œå›å¤´åŒ…â€æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id=2-å®Œæ•´çš„-ros-nat-è„šæœ¬åŒ…å«-web-å›æµ>2. å®Œæ•´çš„ ROS NAT è„šæœ¬ï¼ˆåŒ…å« Web å›æµï¼‰</h2><h4 id=è¯·æ ¹æ®ä½ çš„å®é™…ç«¯å£ä¿®æ”¹-12335-web-å’Œ-21-ftp-ç­‰>è¯·æ ¹æ®ä½ çš„å®é™…ç«¯å£ä¿®æ”¹ 12335 (Web) å’Œ 21 (FTP) ç­‰ã€‚</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>/ip firewall nat
</span></span><span style=display:flex><span># --- åŸºç¡€è§„åˆ™ ---
</span></span><span style=display:flex><span># 1. æ ¸å¿ƒä¸Šç½‘ä¼ªè£…ï¼ˆå¿…é¡»é™åˆ¶åœ¨ WAN å£ï¼Œé˜²æ­¢å¹²æ‰°å…¶ä»–è½¬å‘ï¼‰
</span></span><span style=display:flex><span>add chain=srcnat action=masquerade out-interface=pppoe-out1 comment=&#34;Standard Internet Access&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># --- ç«¯å£è½¬å‘ (DST-NAT) ---
</span></span><span style=display:flex><span># 2. DERP è½¬å‘
</span></span><span style=display:flex><span>add chain=dstnat protocol=tcp dst-port=12340 action=dst-nat to-addresses=10.20.20.4 to-ports=12340 comment=&#34;DERP TCP&#34;
</span></span><span style=display:flex><span>add chain=dstnat protocol=udp dst-port=3478 action=dst-nat to-addresses=10.20.20.4 to-ports=3478 comment=&#34;DERP STUN&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 3. Web æœåŠ¡è½¬å‘ (ç¤ºä¾‹)
</span></span><span style=display:flex><span>add chain=dstnat protocol=tcp dst-port=12335 action=dst-nat to-addresses=10.20.20.x to-ports=12335 comment=&#34;web&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># 4. FTP æœåŠ¡è½¬å‘ (ç¤ºä¾‹)
</span></span><span style=display:flex><span>add chain=dstnat protocol=tcp dst-port=21 action=dst-nat to-addresses=10.20.20.x to-ports=21 comment=&#34;vsftpd&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># --- å›æµè§„åˆ™ (Hairpin NAT) ---
</span></span><span style=display:flex><span># åªæœ‰å½“å†…ç½‘è®¿é—®å†…ç½‘æœåŠ¡å™¨æ—¶æ‰è§¦å‘ã€‚å»ºè®®å°†æ‰€æœ‰å†…ç½‘æœåŠ¡å™¨æ”¾åœ¨ä¸€ä¸ªè§„åˆ™é‡Œï¼Œæˆ–è€…é€ä¸ªæ·»åŠ ã€‚
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># ç»™ DERP æ·»åŠ å›æµ
</span></span><span style=display:flex><span>add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.4 protocol=tcp dst-port=12340 action=masquerade comment=&#34;Hairpin DERP TCP&#34;
</span></span><span style=display:flex><span>add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.4 protocol=udp dst-port=3478 action=masquerade comment=&#34;Hairpin DERP STUN&#34;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># ç»™ Web æœåŠ¡æ·»åŠ å›æµ (å‡è®¾å†…ç½‘ IP ä¸º 10.20.20.5)
</span></span><span style=display:flex><span>add chain=srcnat src-address=10.20.20.0/24 dst-address=10.20.20.5 protocol=tcp dst-port=12335 action=masquerade comment=&#34;Hairpin Web&#34;
</span></span></code></pre></div><h2 id=3-æ“ä½œå»ºè®®ä½¿ç”¨åœ°å€åˆ—è¡¨ç®€åŒ–å›æµ>3. æ“ä½œå»ºè®®ï¼šä½¿ç”¨â€œåœ°å€åˆ—è¡¨â€ç®€åŒ–å›æµ</h2><p>å¦‚æœä½ æœ‰å¾ˆå¤šå†…ç½‘æœåŠ¡å™¨éœ€è¦å›æµï¼Œä¸€æ¡æ¡åŠ  srcnat å¾ˆéº»çƒ¦ã€‚ä½ å¯ä»¥è¿™æ ·åšï¼š</p><p>åœ¨ IP -> Firewall -> Address Lists é‡Œï¼ŒæŠŠæ‰€æœ‰å†…ç½‘æœåŠ¡å™¨ IP åŠ åˆ°ä¸€ä¸ªå« Internal_Servers çš„åˆ—è¡¨ã€‚</p><ol><li>æ“ä½œæ­¥éª¤</li></ol><p>è¯·åœ¨ WinBox ä¸­æŒ‰ç…§ä»¥ä¸‹ä¸¤æ­¥é…ç½®ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šå»ºç«‹æœåŠ¡å™¨åœ°å€åˆ—è¡¨</p><p>åœ¨ IP -> Firewall -> Address Lists ä¸­ï¼Œå°†ä½ æ‰€æœ‰éœ€è¦ä»å†…ç½‘è®¿é—®çš„æœåŠ¡å™¨ IP åŠ å…¥åˆ—è¡¨ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>Name: Internal_Servers | Address: 10.20.20.4 (DERP æœåŠ¡å™¨)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name: Internal_Servers | Address: 10.20.20.5 (Web æœåŠ¡å™¨)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(ä¾æ­¤ç±»æ¨ï¼Œå°†æ‰€æœ‰æœ‰ç«¯å£è½¬å‘éœ€æ±‚çš„å†…ç½‘ IP éƒ½åŠ è¿›å»)
</span></span></code></pre></div><p>ç¬¬äºŒæ­¥ï¼šæ·»åŠ å…¨å±€å›æµè§„åˆ™</p><h3 id=åœ¨-ip---firewall---nat-ä¸­æ·»åŠ è¿™ä¸€æ¡ç¡®ä¿å®ƒåœ¨æ‰€æœ‰-dst-nat-è§„åˆ™ä¹‹åä½†åœ¨åŸºç¡€-masquerade-è§„åˆ™ä¹‹å‰æˆ–è€…ç´§éšå…¶å>åœ¨ IP -> Firewall -> NAT ä¸­æ·»åŠ è¿™ä¸€æ¡ï¼ˆç¡®ä¿å®ƒåœ¨æ‰€æœ‰ dst-nat è§„åˆ™ä¹‹åï¼Œä½†åœ¨åŸºç¡€ masquerade è§„åˆ™ä¹‹å‰ï¼Œæˆ–è€…ç´§éšå…¶åï¼‰ï¼š</h3><p>ä»£ç æ®µ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>/ip firewall nat</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add chain=srcnat src-address=10.20.20.0/24 dst-address-list=Internal_Servers action=masquerade comment=&#34;Global Hairpin NAT&#34;</span>
</span></span></code></pre></div><p>ä½¿ç”¨ Address Listï¼ˆåœ°å€åˆ—è¡¨ï¼‰ çš„æ–¹å¼æœ€ä¸ºé«˜æ•ˆï¼Œä¸éœ€è¦åœ¨ NAT è§„åˆ™é‡ŒæŒ‡å®šç«¯å£ã€‚</p><p>å½“è¯·æ±‚çš„ç›®æ ‡åœ°å€åŒ¹é…åˆ—è¡¨ä¸­çš„ IP æ—¶ï¼ŒRouterOS ä¼šè‡ªåŠ¨å¯¹æ‰€æœ‰åè®®ï¼ˆTCP/UDP/ICMP ç­‰ï¼‰å’Œæ‰€æœ‰ç«¯å£æ‰§è¡Œå›æµæ“ä½œã€‚</p><h4 id=è¿™ä¸€æ¡æ”¾åœ¨natåˆ—è¡¨çš„æœ€ä¸‹é¢å°±è¡Œ>è¿™ä¸€æ¡æ”¾åœ¨natåˆ—è¡¨çš„æœ€ä¸‹é¢å°±è¡Œã€‚</h4><h2 id=4-éªŒè¯-web-æœåŠ¡>4. éªŒè¯ Web æœåŠ¡</h2><p>å¤–ç½‘æµ‹è¯•ï¼šæ‰‹æœºå…³ Wi-Fiï¼Œè®¿é—®åŸŸåï¼Œç¡®è®¤ Web æ­£å¸¸ã€‚</p><p>å†…ç½‘æµ‹è¯•ï¼šæ‰‹æœºè¿ Wi-Fiï¼Œè®¿é—®åŒä¸€ä¸ªåŸŸåã€‚å¦‚æœèƒ½æ‰“å¼€ï¼Œè¯´æ˜å›æµé…ç½®æˆåŠŸã€‚</p><h2 id=5-é…å¥—çš„é˜²ç«å¢™è§„åˆ™ä¹Ÿæ˜¯æˆ‘è‡ªç”¨çš„>5. é…å¥—çš„é˜²ç«å¢™è§„åˆ™ï¼Œä¹Ÿæ˜¯æˆ‘è‡ªç”¨çš„</h2><h3 id=ipv4é˜²ç«å¢™é…ç½®>ipv4é˜²ç«å¢™é…ç½®</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>/ip firewall filter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å…¥ç«™é“¾ (INPUT) - è®¿é—®è·¯ç”±å™¨æœ¬èº«</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;1. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;2. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;3. Accept bridge1 (Internal Admin)&#34; in-interface=bridge1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># é˜²çˆ†ç ´é€»è¾‘ (é’ˆå¯¹ 3981, 2222 ç«¯å£)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;4. Drop Bruteforce IPs&#34; dst-port=3981,2222 protocol=tcp src-address-list=bruteforce_blacklist</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;5. Accept limited connections&#34; connection-limit=10,32 dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=add-src-to-address-list address-list=bruteforce_blacklist address-list-timeout=3d chain=input comment=&#34;6. Add to Bruteforce List&#34; dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;7. Drop excess packets&#34; dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># WANå£ä¸¢å¼ƒä¸å…œåº•</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;8. Drop ICMP from WAN&#34; in-interface=pppoe-out1 protocol=icmp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;9. Drop all other input from WAN&#34; in-interface=pppoe-out1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># è½¬å‘é“¾ (FORWARD) - ç©¿è¿‡è·¯ç”±å™¨ (å¤–ç½‘&lt;-&gt;å†…ç½‘)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. æ—è·¯ç”±è±å… (å¿…é¡»æ”¾åœ¨ Fasttrack å’Œ Invalid ä¸¢å¼ƒä¹‹å‰)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;1. Bypass Fasttrack &amp; Tracking: sing-box out&#34; src-address=10.20.20.6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;2. Bypass Fasttrack &amp; Tracking: sing-box in&#34; dst-address=10.20.20.6</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. ç¡¬ä»¶åŠ é€Ÿ (å¤„ç†å†…ç½‘å…¶ä»–æ­£å¸¸ä¸èµ°ä»£ç†çš„ç›´è¿æµé‡)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=fasttrack-connection chain=forward comment=&#34;3. Fasttrack&#34; connection-state=established,related</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. åŸºç¡€çŠ¶æ€æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;4. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. ä¸¢å¼ƒæ— æ•ˆåŒ… (æ”¾åœ¨æ—è·¯ç”±ä¹‹åï¼Œé˜²æ­¢éå¯¹ç§°è·¯ç”±å›ç¨‹åŒ…è¢«è¯¯æ€)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;5. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. å†…ç½‘æ­£å¸¸è½¬å‘ä¸ç«¯å£æ˜ å°„æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;6. Allow bridge1 forward (Internal Outbound)&#34; in-interface=bridge1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;7. Allow DSTNAT (Port Forwarding)&#34; connection-nat-state=dstnat in-interface=pppoe-out1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. å…¨å±€å…œåº•æ‹¦æˆª (é›¶ä¿¡ä»»åŸåˆ™)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;8. Drop all other forward&#34;</span>
</span></span></code></pre></div><h3 id=è½¬å‘é“¾-forwardç‰¹åˆ«è¯´æ˜>è½¬å‘é“¾ (FORWARD)ç‰¹åˆ«è¯´æ˜ï¼š</h3><p><strong>ç¬¬1æ¡</strong>â€œæ—è·¯ç”±è±å…â€å¡«å…¥ä½ çš„mos+sbçš„ip<br><strong>ç¬¬5æ¡</strong>&ldquo;DST-NAT"è§„åˆ™ï¼šåœ¨ IPv4 çš„ Forward é“¾ä¸­ï¼Œæˆ‘åŠ å…¥äº†ä¸€æ¡ connection-nat-state=dstnatã€‚è¿™ç¡®ä¿äº†ä½ åœ¨ IP -> Firewall -> NAT ä¸­åšçš„ç«¯å£æ˜ å°„èƒ½å¤Ÿç©¿é€ forward çš„å…œåº• drop è§„åˆ™ã€‚
å†…ç½‘äº’é€šï¼šåªè¦æ•°æ®åŒ…è¿›å…¥ bridge1 æ¥å£ï¼Œå°±ä¼šè¢« Allow bridge1 forward æ•è·å¹¶æ”¾è¡Œï¼Œä¸ä¼šå—åˆ°æœ€åä¸€æ¡ drop çš„å½±å“ã€‚<br>è¿™æ ·é…ç½®åï¼Œå±€åŸŸç½‘å†…çš„ PT ä¸‹è½½ã€NAS å¤–éƒ¨å¤§æ–‡ä»¶ä¼ è¾“ç­‰ä¸èµ° 10.20.20.6 çš„ç›´è¿æµé‡ä¾ç„¶å¯ä»¥äº«å—ç¡¬ä»¶åŠ é€Ÿé™ä½ CPU è´Ÿè½½ï¼Œè€Œ sing-box è¿›å‡ºçš„æµé‡åˆ™ç”± CPU ç¨³å¦¥å¤„ç†ï¼Œäº’ä¸å¹²æ‰°</p><h2 id=ipv6é˜²ç«å¢™é…ç½®>ipv6é˜²ç«å¢™é…ç½®</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>/ipv6 firewall filter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å…¥ç«™é“¾ (INPUT) - ä¿æŠ¤è·¯ç”±å™¨æœ¬ä½“</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;1. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;2. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;3. Accept ICMPv6 (Critical for IPv6)&#34; protocol=icmpv6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;4. Allow DHCPv6 Client from WAN&#34; dst-port=546 in-interface=pppoe-out1 protocol=udp src-address=fe80::/10</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;5. Allow bridge1 (Internal Admin)&#34; in-interface=bridge1</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;6. Drop all not from bridge1&#34; in-interface=!bridge1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># è½¬å‘é“¾ (FORWARD) - ç©¿è¿‡è·¯ç”±å™¨ (å¤–ç½‘&lt;-&gt;å†…ç½‘)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ====================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. æ—è·¯ç”±è±å… (å¿…é¡»æ”¾åœ¨ Fasttrack å’Œ Invalid ä¸¢å¼ƒä¹‹å‰)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;1. Bypass Fasttrack &amp; Tracking: sing-box out&#34; src-address=fd88::6666</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;2. Bypass Fasttrack &amp; Tracking: sing-box in&#34; dst-address=fd88::6666</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. ç¡¬ä»¶åŠ é€Ÿ (å¤„ç†æ­£å¸¸ä¸èµ°ä»£ç†çš„ IPv6 ç›´è¿æµé‡)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=fasttrack-connection chain=forward comment=&#34;3. Fasttrack&#34; connection-state=established,related</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. åŸºç¡€çŠ¶æ€æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;4. Accept forward established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. ä¸¢å¼ƒæ— æ•ˆåŒ… (é˜²æ­¢æ—è·¯ç”±éå¯¹ç§°å›ç¨‹åŒ…è¢«è¯¯æ€)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;5. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. æ ¸å¿ƒåè®®ä¸å†…ç½‘æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;6. Accept Forward ICMPv6&#34; protocol=icmpv6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;7. Allow bridge1 forward (Internal Outbound)&#34; in-interface=bridge1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- æš´éœ²å†…ç½‘æœåŠ¡ (æ³¨æ„ï¼šæ›¿æ¢ä¸ºå®é™…å…¬ç½‘ IPv6 åœ°å€åå†æŒ‰éœ€å¯ç”¨) ---</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;8. Allow NPM (HTTP/HTTPS)&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=80,443 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;9. Allow Hysteria2/Proxy&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=36789 protocol=udp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;10. Allow Shadowsocks&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=36789 protocol=tcp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. å…œåº•æ‹¦æˆª (é›¶ä¿¡ä»»åŸåˆ™)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;11. Drop all other forward (Protect LAN)&#34;</span>
</span></span></code></pre></div><p><strong>å…³é”®æé†’ï¼š</strong>
ä¿®æ”¹æ—è·¯ç”±çš„ipä¸ºä½ çš„ipv6åœ°å€<br>å¦‚æœä½ çš„å®½å¸¦æ˜¯åŠ¨æ€ IPv6 å‰ç¼€ï¼ˆPDï¼‰ï¼ŒæœåŠ¡å™¨çš„å®Œæ•´ IPv6 åœ°å€ä¼šå˜åŒ–ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œä¸åº”ç›´æ¥å†™æ­» dst-addressï¼Œè€Œæ˜¯éœ€è¦ç»“åˆ MikroTik çš„ IPv6 Firewall Address Lists åŠŸèƒ½ï¼Œæˆ–è€…ä½¿ç”¨ in-interface=pppoe-out1 é…åˆ out-interface=bridge1 åŠ ä¸Šç‰¹å®šè®¾å¤‡çš„ç‰¹å®šåŒ¹é…è§„åˆ™ï¼ˆæ¯”å¦‚é€šè¿‡é˜²ç«å¢™è„šæœ¬åŠ¨æ€æ›´æ–°ï¼‰ã€‚</p><p>IPv4 ä¾é  NATï¼Œä¸ä¸»åŠ¨æ˜ å°„å¤–éƒ¨è¿›ä¸æ¥ï¼›ä½† IPv6 æ˜¯ç«¯åˆ°ç«¯ç›´é€šï¼ˆæ²¡æœ‰ NATï¼‰ã€‚
ä½ åœ¨ forward é“¾ä¸­æ”¾è¡Œ dst-port=80,443ï¼Œå´æ²¡æœ‰æŒ‡å®šç›®æ ‡åœ°å€ (dst-address)ã€‚ä¸€æ—¦å¯ç”¨ï¼Œè¿™ä»£è¡¨å…¬ç½‘å¯ä»¥è®¿é—®ä½ å±€åŸŸç½‘å†…æ‰€æœ‰è®¾å¤‡çš„ 80 å’Œ 443 ç«¯å£ï¼ˆåŒ…æ‹¬å…‰çŒ«ã€è·¯ç”±å™¨åå°ã€æ™ºèƒ½å®¶å±…ã€å…¶ä»–ç”µè„‘ç­‰ï¼‰ã€‚</p><p>æ­£ç¡®åšæ³•ï¼šå¿…é¡»ä¸¥æ ¼ç»‘å®šç›®æ ‡æœåŠ¡å™¨çš„ IPv6 åœ°å€ï¼ˆdst-address=æœåŠ¡å™¨IPv6åœ°å€ï¼‰ï¼Œæˆ–è€…é€šè¿‡ MAC åœ°å€è‡ªåŠ¨è·å–åˆ°çš„ IPv6 åç¼€ã€‚</p><p>##å¦‚æœæˆ‘åˆ›å»ºäº†ï¼š</p><h4 id=1-åˆ›å»ºåˆ—è¡¨åç§°>1. åˆ›å»ºåˆ—è¡¨åç§°</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>/interface list
</span></span><span style=display:flex><span>add name=WAN
</span></span><span style=display:flex><span>add name=LAN
</span></span></code></pre></div><h4 id=2-å°†-pppoe-out1-åŠ å…¥-wan-åˆ—è¡¨>2. å°† pppoe-out1 åŠ å…¥ WAN åˆ—è¡¨</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>/interface list member
</span></span><span style=display:flex><span>add interface=pppoe-out1 list=WAN
</span></span></code></pre></div><h4 id=3-å°†-bridge1-åŠ å…¥-lan-åˆ—è¡¨>3. å°† bridge1 åŠ å…¥ LAN åˆ—è¡¨</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>add interface=bridge1 list=LAN
</span></span></code></pre></div><h2 id=ipv4vsipv6é˜²ç«å¢™å¯¹åº”æ›´æ”¹>IPV4vsIPV6é˜²ç«å¢™å¯¹åº”æ›´æ”¹ï¼š</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># å‡†å¤‡å·¥ä½œï¼šæ¸…ç©ºç°æœ‰ IPv4 å’Œ IPv6 è¿‡æ»¤è§„åˆ™</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>/ip firewall filter remove [find]</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>/ipv6 firewall filter remove [find]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç¬¬ä¸€éƒ¨åˆ†ï¼šIPv4 é˜²ç«å¢™è§„åˆ™ (å·²é€‚é… Interface List)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>/ip firewall filter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- å…¥ç«™é“¾ (INPUT) - ä¿æŠ¤è·¯ç”±å™¨æœ¬ä½“ ---</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;1. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;2. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;3. Accept LAN (Internal Admin)&#34; in-interface-list=LAN</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># é˜²çˆ†ç ´é€»è¾‘</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;4. Drop Bruteforce IPs&#34; dst-port=3981,2222 protocol=tcp src-address-list=bruteforce_blacklist</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;5. Accept limited connections&#34; connection-limit=10,32 dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=add-src-to-address-list address-list=bruteforce_blacklist address-list-timeout=3d chain=input comment=&#34;6. Add to Bruteforce List&#34; dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;7. Drop excess packets&#34; dst-port=3981,2222 protocol=tcp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># WANå£ä¸¢å¼ƒå…œåº•</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;8. Drop ICMP from WAN&#34; in-interface-list=WAN protocol=icmp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;9. Drop all other input from WAN&#34; in-interface-list=WAN</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- è½¬å‘é“¾ (FORWARD) - ç©¿è¿‡è·¯ç”±å™¨ ---</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. æ—è·¯ç”±è±å…</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;1. Bypass Fasttrack &amp; Tracking: sing-box out&#34; src-address=10.20.20.6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;2. Bypass Fasttrack &amp; Tracking: sing-box in&#34; dst-address=10.20.20.6</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. ç¡¬ä»¶åŠ é€Ÿ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=fasttrack-connection chain=forward comment=&#34;3. Fasttrack&#34; connection-state=established,related</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. åŸºç¡€çŠ¶æ€æ”¾è¡Œä¸ä¸¢å¼ƒ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;4. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;5. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. å†…ç½‘æ­£å¸¸è½¬å‘ä¸ç«¯å£æ˜ å°„æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;6. Allow LAN forward (Internal Outbound)&#34; in-interface-list=LAN</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;7. Allow DSTNAT (Port Forwarding)&#34; connection-nat-state=dstnat in-interface-list=WAN</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. å…¨å±€å…œåº•æ‹¦æˆª</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;8. Drop all other forward&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ç¬¬äºŒéƒ¨åˆ†ï¼šIPv6 é˜²ç«å¢™è§„åˆ™ (å·²é€‚é… Interface List)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ==========================================</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>/ipv6 firewall filter</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- å…¥ç«™é“¾ (INPUT) - ä¿æŠ¤è·¯ç”±å™¨æœ¬ä½“ ---</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;1. Accept established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;2. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;3. Accept ICMPv6 (Critical for IPv6)&#34; protocol=icmpv6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;4. Allow DHCPv6 Client from WAN&#34; dst-port=546 in-interface-list=WAN protocol=udp src-address=fe80::/10</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=input comment=&#34;5. Allow LAN (Internal Admin)&#34; in-interface-list=LAN</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=input comment=&#34;6. Drop all not from LAN&#34; in-interface-list=!LAN</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># --- è½¬å‘é“¾ (FORWARD) - ç©¿è¿‡è·¯ç”±å™¨ ---</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. æ—è·¯ç”±è±å…</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;1. Bypass Fasttrack &amp; Tracking: sing-box out&#34; src-address=fd88::6666</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;2. Bypass Fasttrack &amp; Tracking: sing-box in&#34; dst-address=fd88::6666</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. ç¡¬ä»¶åŠ é€Ÿ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=fasttrack-connection chain=forward comment=&#34;3. Fasttrack&#34; connection-state=established,related</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. åŸºç¡€çŠ¶æ€æ”¾è¡Œä¸ä¸¢å¼ƒ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;4. Accept forward established,related,untracked&#34; connection-state=established,related,untracked</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;5. Drop invalid&#34; connection-state=invalid</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. æ ¸å¿ƒåè®®ä¸å†…ç½‘æ”¾è¡Œ</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;6. Accept Forward ICMPv6&#34; protocol=icmpv6</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;7. Allow LAN forward (Internal Outbound)&#34; in-interface-list=LAN</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. æš´éœ²å†…ç½‘æœåŠ¡ (æ›¿æ¢ä¸ºå®é™…å…¬ç½‘ IPv6 åœ°å€åå†æŒ‰éœ€å¯ç”¨)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;8. Allow NPM (HTTP/HTTPS)&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=80,443 protocol=tcp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;9. Allow Hysteria2/Proxy&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=36789 protocol=udp</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=accept chain=forward comment=&#34;10. Allow Shadowsocks&#34; disabled=yes dst-address=240e::xxxx:xxxx dst-port=36789 protocol=tcp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 6. å…œåº•æ‹¦æˆª</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>add action=drop chain=forward comment=&#34;11. Drop all other forward (Protect LAN)&#34;</span>
</span></span></code></pre></div><h2 id=ipv6çš„ndç…§ç€æ“ä½œå³å¯>IPV6çš„NDç…§ç€æ“ä½œå³å¯</h2><p><img src=assets/1.png alt=1></p><div id=utterances-comments><script src=https://utteranc.es/client.js repo=hanigege/blog-comments issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div class=aside__about><span class=about__logo role=img>ğŸš</span>&nbsp;<h1 class=about__title>root</h1><p class=about__description>å€‹äººè‡ªç•™åœ°ï¼Œå¦‚æœèƒ½å¹«åˆ°ä½ ï¼Œæˆ‘ä¹Ÿæœƒå¾ˆé«˜èˆˆã€‚</p></div><ul class=aside__social-links><li><a href=mailto:purodn@gmail.com rel=me aria-label=Email title=Email><i class="fa-solid fa-envelope" aria-hidden=true></i></a>&nbsp;</li></ul></div><hr><div class=aside__content><p>2026-02-27</p><hr>On this page:<nav id=TableOfContents><ol><li><a href=#å†…ç½‘çš„dst-natè¦åŠ å¤–ç½‘æ¥å£å¦‚pppoe-out1>å†…ç½‘çš„dst-natè¦åŠ å¤–ç½‘æ¥å£å¦‚pppoe-out1</a></li><li><a href=#1-ä¸ºä»€ä¹ˆéœ€è¦å›æµ>1. ä¸ºä»€ä¹ˆéœ€è¦å›æµï¼Ÿ</a></li><li><a href=#2-å®Œæ•´çš„-ros-nat-è„šæœ¬åŒ…å«-web-å›æµ>2. å®Œæ•´çš„ ROS NAT è„šæœ¬ï¼ˆåŒ…å« Web å›æµï¼‰</a><ol><li></li></ol></li><li><a href=#3-æ“ä½œå»ºè®®ä½¿ç”¨åœ°å€åˆ—è¡¨ç®€åŒ–å›æµ>3. æ“ä½œå»ºè®®ï¼šä½¿ç”¨â€œåœ°å€åˆ—è¡¨â€ç®€åŒ–å›æµ</a><ol><li><a href=#åœ¨-ip---firewall---nat-ä¸­æ·»åŠ è¿™ä¸€æ¡ç¡®ä¿å®ƒåœ¨æ‰€æœ‰-dst-nat-è§„åˆ™ä¹‹åä½†åœ¨åŸºç¡€-masquerade-è§„åˆ™ä¹‹å‰æˆ–è€…ç´§éšå…¶å>åœ¨ IP -> Firewall -> NAT ä¸­æ·»åŠ è¿™ä¸€æ¡ï¼ˆç¡®ä¿å®ƒåœ¨æ‰€æœ‰ dst-nat è§„åˆ™ä¹‹åï¼Œä½†åœ¨åŸºç¡€ masquerade è§„åˆ™ä¹‹å‰ï¼Œæˆ–è€…ç´§éšå…¶åï¼‰ï¼š</a></li></ol></li><li><a href=#4-éªŒè¯-web-æœåŠ¡>4. éªŒè¯ Web æœåŠ¡</a></li><li><a href=#5-é…å¥—çš„é˜²ç«å¢™è§„åˆ™ä¹Ÿæ˜¯æˆ‘è‡ªç”¨çš„>5. é…å¥—çš„é˜²ç«å¢™è§„åˆ™ï¼Œä¹Ÿæ˜¯æˆ‘è‡ªç”¨çš„</a><ol><li><a href=#ipv4é˜²ç«å¢™é…ç½®>ipv4é˜²ç«å¢™é…ç½®</a></li><li><a href=#è½¬å‘é“¾-forwardç‰¹åˆ«è¯´æ˜>è½¬å‘é“¾ (FORWARD)ç‰¹åˆ«è¯´æ˜ï¼š</a></li></ol></li><li><a href=#ipv6é˜²ç«å¢™é…ç½®>ipv6é˜²ç«å¢™é…ç½®</a><ol><li></li></ol></li><li><a href=#ipv4vsipv6é˜²ç«å¢™å¯¹åº”æ›´æ”¹>IPV4vsIPV6é˜²ç«å¢™å¯¹åº”æ›´æ”¹ï¼š</a></li><li><a href=#ipv6çš„ndç…§ç€æ“ä½œå³å¯>IPV6çš„NDç…§ç€æ“ä½œå³å¯</a></li></ol></nav></div></section><footer class=page__footer><p class=copyright>Â© <strong>felix</strong>.</p><p class=advertisement>Powered by <a>bash&sh</a>.</p></footer></div></body></html>