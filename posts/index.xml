<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on 代碼倉庫</title>
    <link>https://hanigege.github.io/posts/</link>
    <description>Recent content in Posts on 代碼倉庫</description>
    <generator>Hugo</generator>
    <language>zh-CN</language>
    <copyright>© **石榴**.</copyright>
    <lastBuildDate>Sun, 11 May 2025 00:58:10 +0800</lastBuildDate>
    <atom:link href="https://hanigege.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>出国自建voip(三.2）Telegram机器人连接程序自启动（补充篇）</title>
      <link>https://hanigege.github.io/posts/telegram-sms-bot2/</link>
      <pubDate>Sun, 11 May 2025 00:58:10 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/telegram-sms-bot2/</guid>
      <description>&lt;h2 id=&#34;rootsms-source-myenvbinactivate&#34;&gt;root@sms:~# source myenv/bin/activate&lt;/h2&gt;&#xA;&lt;h2 id=&#34;激活虚拟环境&#34;&gt;激活虚拟环境&lt;/h2&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;source myenv/bin/activate &#xA;&lt;/code&gt;&lt;/pre&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;(myenv) root@sms:~# nohup python sms3.py &amp;gt; sms.log 2&amp;gt;&amp;amp;1 &amp;amp;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;后台启动sms3.py&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;nohup python sms3.py &amp;gt; sms.log 2&amp;gt;&amp;amp;1 &amp;amp;&#xA;or&#xA;nohup python sms.py &amp;gt; sms.log 2&amp;gt;&amp;amp;1 &amp;amp;&#xA;(myenv) root@sms:~#&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;上面的两条命令能不能做成脚本，设置为开机自启动&lt;/p&gt;&#xA;&lt;p&gt;可以的，你可以创建一个 systemd 服务 或者 编写一个 shell 脚本 来实现 Python 虚拟环境的激活 并 运行 sms3.py 脚本，同时设置为 开机自启动。&lt;/p&gt;&#xA;&lt;p&gt;方法 1：使用 systemd (推荐)&#xA;适用于 Debian/Ubuntu 及大多数 Linux 发行版。&lt;/p&gt;&#xA;&lt;p&gt;步骤 1：创建 systemd 服务文件&#xA;运行以下命令，创建 sms3.service：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;nano /etc/systemd/system/sms3.service&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;填入以下内容：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;[Unit]&#xA;Description=SMS Python Service&#xA;After=network.target&#xA;&#xA;[Service]&#xA;User=root&#xA;WorkingDirectory=/root&#xA;ExecStart=/root/myenv/bin/python /root/sms3.py&#xA;Restart=always&#xA;StandardOutput=append:/root/sms.log&#xA;StandardError=append:/root/sms.log&#xA;&#xA;[Install]&#xA;WantedBy=multi-user.target&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;⚠ 注意：&lt;/p&gt;</description>
    </item>
    <item>
      <title>出国自建voip(三）连接Telegram机器人本地安装</title>
      <link>https://hanigege.github.io/posts/telegram-sms-bot/</link>
      <pubDate>Sun, 11 May 2025 00:39:56 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/telegram-sms-bot/</guid>
      <description>&lt;h3 id=&#34;前提是telegram自己的机器人提前生成好并获取相应的密钥&#34;&gt;前提是telegram自己的机器人提前生成好，并获取相应的密钥&lt;/h3&gt;&#xA;&lt;h1 id=&#34;打开一台虚拟机建议debian12&#34;&gt;打开一台虚拟机（建议debian12)&lt;/h1&gt;&#xA;&lt;h2 id=&#34;方法-1使用虚拟环境&#34;&gt;方法 1：使用虚拟环境&lt;/h2&gt;&#xA;&lt;p&gt;创建一个 Python 虚拟环境，并在其中安装所需的库。这样可以避免系统级 Python 环境的冲突。&lt;/p&gt;&#xA;&lt;p&gt;安装 python3-venv（如果未安装）&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt update&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;apt install python3&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;venv&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;创建一个新的虚拟环境&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt; python3 &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;m venv myenv&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;激活虚拟环境&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;source myenv&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;bin&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;activate&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;在虚拟环境中安装 python-telegram-bot&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;pip install python&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;telegram&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;bot smpplib&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;运行脚本：你可以在虚拟环境中运行你的 Telegram 机器人脚本,脚本&lt;code&gt;sms.py&lt;/code&gt;下载&#xA;命令：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;python sms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;py&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;退出虚拟环境：&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;deactivate&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;运行脚本有三种方案一种是运行在tmux虚拟窗口下二种是直接本地后台运行三种systemd进行管理-建议第三种&#34;&gt;运行脚本有三种方案，一种是运行在tmux虚拟窗口下，二种是直接本地后台运行，三种systemd进行管理 （建议第三种）&lt;/h2&gt;&#xA;&lt;p&gt;以上要运行在虚拟窗口下，建议使用tmux&lt;/p&gt;&#xA;&lt;h4 id=&#34;1使用-tmux&#34;&gt;1.使用 tmux&lt;/h4&gt;&#xA;&lt;p&gt;安装（如果未安装）：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;apt-get install tmux       # Debian/Ubuntu &#xA;yum install tmux           # CentOS/RHEL&#xA;启动 Tmux 会话：&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;tmux&lt;/strong&gt;&#xA;按 Ctrl+B，然后按 D，会返回终端。&lt;/p&gt;&#xA;&lt;p&gt;关闭 SSH，程序继续运行。&lt;/p&gt;&#xA;&lt;p&gt;重新连接：&lt;/p&gt;&#xA;&lt;p&gt;列出会话：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;tmux ls&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;输出示例：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;0: 1 windows (created ...)&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;恢复会话：&lt;/p&gt;</description>
    </item>
    <item>
      <title>Vyos上网系统之-vyos命令技巧集(3)</title>
      <link>https://hanigege.github.io/posts/vyos-jiqiao-3/</link>
      <pubDate>Sat, 10 May 2025 21:35:04 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/vyos-jiqiao-3/</guid>
      <description>&lt;h2 id=&#34;你可以使用-delete-和-set-命令来修改-network-group-的子网&#34;&gt;你可以使用 delete 和 set 命令来修改 network-group 的子网。&lt;/h2&gt;&#xA;&lt;p&gt;修改 LAN-v4 的网络&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;删除原来的 192.168.10.0/24&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;delete firewall group network-group LAN-v4 network 192.168.10.0/24&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;添加新的 192.168.100.0/24&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set firewall group network-group LAN-v4 network 192.168.100.0/24&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;提交并保存&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;commit&#xA;save&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;验证修改是否生效&lt;/p&gt;&#xA;&lt;p&gt;执行以下命令：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;show firewall group network-group LAN-v4&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果输出如下，就说明修改成功：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; network-group LAN-v4 {&#xA;     network 192.168.100.0/24&#xA; }&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;在 VyOS 中，你可以使用以下命令查看 所有配置：&#xA;显示完整的层级配置（推荐）&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;show configuration&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个命令会以 层级结构 显示整个配置，类似于 show running-config。&lt;/p&gt;&#xA;&lt;p&gt;显示所有配置命令（适合复制）($ 模式下）&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;show configuration commands&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个命令会以 show 命令的格式 展示所有配置，适用于备份或复制配置：&lt;/p&gt;&#xA;&lt;p&gt;按层级展开查看（交互式）&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;show configuration level 2&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;level 2 代表展开到第 2 层，你可以调整 level 数值来控制显示的详细程度。&lt;/p&gt;</description>
    </item>
    <item>
      <title>Vyos上网系列之-Fakeip配置(2)</title>
      <link>https://hanigege.github.io/posts/vyos-fakeip-2/</link>
      <pubDate>Sat, 10 May 2025 21:25:08 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/vyos-fakeip-2/</guid>
      <description>&lt;h2 id=&#34;对于终端网关是vyos的通过mosdns来分流realip和fakeip的流量-可这样配置&#34;&gt;对于终端网关是vyos的，通过mosdns来分流realip和fakeip的流量, 可这样配置:&lt;/h2&gt;&#xA;&lt;p&gt;(vyos的group分为address-group,network-group等)&lt;/p&gt;&#xA;&lt;h4 id=&#34;定义组-ip例&#34;&gt;定义组 IP例:&lt;/h4&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set firewall group address-group Telegram-v4 address &amp;#39;157.148.47.204&amp;#39;&#xA;set firewall group address-group Telegram-v4 address &amp;#39;182.43.124.6&amp;#39;&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;定义组网段v4例&#34;&gt;定义组网段V4例：&lt;/h4&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.56.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.4.0/22&amp;#39;&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;定义组telegram V4:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set firewall group network-group Telegram-v4 network &amp;#39;91.108.56.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.4.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.8.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.16.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.12.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;149.154.160.0/20&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.105.192.0/23&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;91.108.20.0/22&amp;#39;&#xA;set firewall group network-group Telegram-v4 network &amp;#39;185.76.151.0/24&amp;#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h4 id=&#34;定义组ip-v6例&#34;&gt;定义组ip-V6例：&lt;/h4&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set firewall group ipv6-address-group Telegram-v6 address &amp;#39;2a00:1098:80:2::1004&amp;#39;&#xA;set firewall group ipv6-address-group Telegram-v6 address &amp;#39;2a00:1098:80:2::1001&amp;#39;&#xA;...&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;定义组网段V6例：&lt;/p&gt;</description>
    </item>
    <item>
      <title>Vyos上网系列之-上网配置（1）</title>
      <link>https://hanigege.github.io/posts/vyos-jibenshangwang-1/</link>
      <pubDate>Sat, 10 May 2025 21:04:17 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/vyos-jibenshangwang-1/</guid>
      <description>&lt;h4 id=&#34;vyos的命令行界面是基于shell的没有图形界面-但是可以用tab自动补全&#34;&gt;vyos的命令行界面是基于shell的，没有图形界面, 但是可以用tab自动补全.&lt;/h4&gt;&#xA;&lt;p&gt;本文的vyos命令是基于vyos的vyos-rolling-nightly-builds的1.5.x版本.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;**特别感谢大卫佬给予的指导与帮助**&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;pve安装vyos&#34;&gt;pve安装vyos:&lt;/h2&gt;&#xA;&lt;p&gt;下载nightly-build: &lt;a href=&#34;https://github.com/vyos/vyos-nightly-build/releases&#34;&gt;https://github.com/vyos/vyos-nightly-build/releases&lt;/a&gt;&#xA;pve的虚拟机设置和安装(略), 建议内存2G, 磁盘10G或更大, 因为vyos可以运行容器, vyos用podman管理容器.&lt;/p&gt;&#xA;&lt;p&gt;vm运行后, 用vyos:vyos登录. 用命令&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;install image&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;安装vyos.&lt;/p&gt;&#xA;&lt;p&gt;进入配置模式：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;configure&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;生效：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;commit&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;保存配置：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;save&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;取消生效的,未保存的配置：&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;discard&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;下面开始配置随时都可以输入生效命令如果不保存重启后配置会失效&#34;&gt;下面开始配置，随时都可以输入生效命令，如果不保存，重启后配置会失效&lt;/h2&gt;&#xA;&lt;p&gt;设置ssh登录:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set service ssh port &amp;#39;22&amp;#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;创建用户gary:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set system login user gary full-name gary&#xA;set system login user gary authentication plaintext-password &amp;#39;密码&amp;#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;建议ssh密钥登录:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set system login user gary authentication public-keys gary@laptop key &amp;#39;your-public-key&amp;#39;&#xA;set system login user gary authentication public-keys gary@laptop type &amp;#39;ssh-rsa&amp;#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;禁用默认的vyos用户:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set system login user vyos disable&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;设置系统的hostname:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;set system host-name &amp;#39;vyos&amp;#39;&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;查看系统的hostname&lt;/p&gt;</description>
    </item>
    <item>
      <title>RosIPV6配置方案</title>
      <link>https://hanigege.github.io/posts/ros-ipv6-set/</link>
      <pubDate>Thu, 08 May 2025 20:37:25 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/ros-ipv6-set/</guid>
      <description>&lt;h2 id=&#34;ipv6最终配置定型&#34;&gt;ipv6最终配置定型：&lt;/h2&gt;</description>
    </item>
    <item>
      <title>vyos多网口小主机桥接配置(完整）</title>
      <link>https://hanigege.github.io/posts/vyos-qiaojie-4kou/</link>
      <pubDate>Wed, 07 May 2025 23:30:18 +0800</pubDate>
      <guid>https://hanigege.github.io/posts/vyos-qiaojie-4kou/</guid>
      <description>&lt;h3 id=&#34;一基本上网配置&#34;&gt;一.基本上网配置&lt;/h3&gt;&#xA;&lt;h3 id=&#34;vyos的命令行界面是基于shell的没有图形界面-但是可以用tab自动补全&#34;&gt;vyos的命令行界面是基于shell的，没有图形界面, 但是可以用tab自动补全&lt;/h3&gt;&#xA;&lt;p&gt;本文的vyos命令是基于vyos的vyos-rolling-nightly-builds的1.5.x版本.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
